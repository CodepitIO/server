<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Xenia and Dominoes</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Xenia likes puzzles very much. She is especially fond of the puzzles that consist of domino pieces. Look at the picture that shows one of such puzzles.</p><center> <img class="tex-graphics" src="http://codeforces.com/predownloaded/84/81/8481e23edc8b0a7c0c6ffbdafe907753a3852d69.png"> </center><p>A puzzle is a <span class="tex-span">3&#x2009;&#xD7;&#x2009;<i>n</i></span> table with forbidden cells (black squares) containing dominoes (colored rectangles on the picture). A puzzle is called <span class="tex-font-style-it">correct</span> if it meets the following conditions:</p><ul> <li> each domino occupies exactly two non-forbidden cells of the table; </li><li> no two dominoes occupy the same table cell; </li><li> exactly one non-forbidden cell of the table is unoccupied by any domino (it is marked by a circle in the picture). </li></ul><p>To solve the puzzle, you need multiple steps to transport an empty cell from the starting position to some specified position. A move is transporting a domino to the empty cell, provided that the puzzle stays correct. <span class="tex-font-style-bf">The horizontal dominoes can be moved only horizontally, and vertical dominoes can be moved only vertically. You can&apos;t rotate dominoes.</span> The picture shows a probable move.</p><p>Xenia has a <span class="tex-span">3&#x2009;&#xD7;&#x2009;<i>n</i></span> table with forbidden cells and a cell marked with a circle. Also, Xenia has very many identical dominoes. Now Xenia is wondering, how many distinct correct puzzles she can make if she puts dominoes on the existing table. Also, Xenia wants the circle-marked cell to be empty in the resulting puzzle. The puzzle must contain at least one move.</p><p>Help Xenia, count the described number of puzzles. As the described number can be rather large, print the remainder after dividing it by <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup>&#x2009;+&#x2009;7)</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integer <span class="tex-span"><i>n</i></span> <span class="tex-span">(3&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">4</sup>)</span> &#x2014; the puzzle&apos;s size. Each of the following three lines contains <span class="tex-span"><i>n</i></span> characters &#x2014; the description of the table. The <span class="tex-span"><i>j</i></span>-th character of the <span class="tex-span"><i>i</i></span>-th line equals &quot;<span class="tex-font-style-tt">X</span>&quot; if the corresponding cell is forbidden; it equals &quot;<span class="tex-font-style-tt">.</span>&quot;, if the corresponding cell is non-forbidden and &quot;<span class="tex-font-style-tt">O</span>&quot;, if the corresponding cell is marked with a circle.</p><p>It is guaranteed that exactly one cell in the table is marked with a circle. It is guaranteed that all cells of a given table having at least one common point with the marked cell is non-forbidden.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number &#x2014; the answer to the problem modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup>&#x2009;+&#x2009;7)</span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br>....X<br>.O...<br>...X.<br></pre></div><div class="output"><div class="title">Output</div><pre>1<br></pre></div><div class="input"><div class="title">Input</div><pre>5<br>.....<br>.O...<br>.....<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br></pre></div><div class="input"><div class="title">Input</div><pre>3<br>...<br>...<br>..O<br></pre></div><div class="output"><div class="title">Output</div><pre>4<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Two puzzles are considered distinct if there is a pair of cells that contain one domino in one puzzle and do not contain it in the other one.</p></div></div></div>
</div>