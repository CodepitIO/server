<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Little Pony and Elements of Harmony</div><div class="time-limit"><div class="property-title">time limit per test</div>6 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Elements of Harmony are six supernatural artifacts representing subjective aspects of harmony. They are arguably the most powerful force in Equestria. The inside of Elements of Harmony can be seen as a complete graph with <span class="tex-span"><i>n</i></span> vertices labeled from 0 to <span class="tex-span"><i>n</i>&#x2009;-&#x2009;1</span>, where <span class="tex-span"><i>n</i></span> is a power of two, equal to <span class="tex-span">2<sup class="upper-index"><i>m</i></sup></span>.</p><center> <img class="tex-graphics" src="http://codeforces.com/predownloaded/45/5c/455ced2cf975662cf88670360728403f08049acf.png"> </center><p>The energy in Elements of Harmony is in constant movement. According to the ancient book, the energy of vertex <span class="tex-span"><i>u</i></span> in time <span class="tex-span"><i>i</i></span> <span class="tex-span">(<i>e</i><sub class="lower-index"><i>i</i></sub>[<i>u</i>])</span> equals to: </p><center class="tex-equation"><img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/1a/8f/1a8fa8fb37452584c7139c096d558d101a3ea76e.png"></center><p>Here <span class="tex-span"><i>b</i>[]</span> is the transformation coefficient &#x2014; an array of <span class="tex-span"><i>m</i>&#x2009;+&#x2009;1</span> integers and <span class="tex-span"><i>f</i>(<i>u</i>,&#x2009;<i>v</i>)</span> is the number of ones in the binary representation of number <span class="tex-span">(<i>u</i>&#xA0;<i>xor</i>&#xA0;<i>v</i>)</span>.</p><p>Given the transformation coefficient and the energy distribution at time 0 <span class="tex-span">(<i>e</i><sub class="lower-index">0</sub>[])</span>. Help Twilight Sparkle predict the energy distribution at time <span class="tex-span"><i>t</i></span> <span class="tex-span">(<i>e</i><sub class="lower-index"><i>t</i></sub>[])</span>. The answer can be quite large, so output it modulo <span class="tex-span"><i>p</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three integers <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>t</i></span> and <span class="tex-span"><i>p</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;20;&#xA0;0&#x2009;&#x2264;&#x2009;<i>t</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">18</sup>;&#xA0;2&#x2009;&#x2264;&#x2009;<i>p</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">9</sup></span>). The following line contains <span class="tex-span"><i>n</i></span> (<span class="tex-span"><i>n</i>&#x2009;=&#x2009;2<sup class="upper-index"><i>m</i></sup></span>) integers <span class="tex-span"><i>e</i><sub class="lower-index">0</sub>[<i>i</i>]</span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>e</i><sub class="lower-index">0</sub>[<i>i</i>]&#x2009;&#x2264;&#x2009;10<sup class="upper-index">9</sup>;&#xA0;0&#x2009;&#x2264;&#x2009;<i>i</i>&#x2009;&lt;&#x2009;<i>n</i></span>). The next line contains <span class="tex-span"><i>m</i>&#x2009;+&#x2009;1</span> integers <span class="tex-span"><i>b</i>[<i>i</i>]</span> (<span class="tex-span">0&#x2009;&#x2264;&#x2009;<i>b</i>[<i>i</i>]&#x2009;&#x2264;&#x2009;10<sup class="upper-index">9</sup>;&#xA0;0&#x2009;&#x2264;&#x2009;<i>i</i>&#x2009;&#x2264;&#x2009;<i>m</i></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output <span class="tex-span"><i>n</i></span> lines, the <span class="tex-span"><i>i</i></span>-th line must contain a single integer <span class="tex-span"><i>e</i><sub class="lower-index"><i>t</i></sub>[<i>i</i>]</span> modulo <span class="tex-span"><i>p</i></span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 2 10000<br>4 1 2 3<br>0 1 0<br></pre></div><div class="output"><div class="title">Output</div><pre>14<br>6<br>6<br>14<br></pre></div></div></div></div></div>
</div>