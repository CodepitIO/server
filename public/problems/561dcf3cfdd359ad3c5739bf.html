<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Dima and Bacteria</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Dima took up the biology of bacteria, as a result of his experiments, he invented <span class="tex-span"><i>k</i></span> types of bacteria. Overall, there are <span class="tex-span"><i>n</i></span> bacteria at his laboratory right now, and the number of bacteria of type <span class="tex-span"><i>i</i></span> equals <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span>. For convenience, we will assume that all the bacteria are numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>. The bacteria of type <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> are numbered from <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/32/41/3241dae802ac5cf1c20288ebd2eb882ab9ceddfe.png"> to <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/8a/5a/8a5a323de2224d5dd840c8fade8ef0a8a5ef7383.png">.</p><p>With the help of special equipment Dima can move energy from some bacteria into some other one. Of course, the use of such equipment is not free. Dima knows <span class="tex-span"><i>m</i></span> ways to move energy from some bacteria to another one. The way with number <span class="tex-span"><i>i</i></span> can be described with integers <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> mean that this way allows moving energy from bacteria with number <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub></span> to bacteria with number <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span> or vice versa for <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> dollars.</p><p>Dima&apos;s Chef (Inna) calls the type-distribution <span class="tex-font-style-it">correct</span> if there is a way (may be non-direct) to move energy from any bacteria of the particular type to any other bacteria of the same type (between any two bacteria of the same type) for zero cost.</p><p>As for correct type-distribution the cost of moving the energy depends only on the types of bacteria help Inna to determine is the type-distribution correct? If it is, print the matrix <span class="tex-span"><i>d</i></span> with size <span class="tex-span"><i>k</i>&#x2009;&#xD7;&#x2009;<i>k</i></span>. Cell <span class="tex-span"><i>d</i>[<i>i</i>][<i>j</i>]</span> of this matrix must be equal to the minimal possible cost of energy-moving from bacteria with type <span class="tex-span"><i>i</i></span> to bacteria with type <span class="tex-span"><i>j</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three integers <span class="tex-span"><i>n</i>,&#x2009;<i>m</i>,&#x2009;<i>k</i></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup>;&#xA0;0&#x2009;&#x2264;&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup>;&#xA0;1&#x2009;&#x2264;&#x2009;<i>k</i>&#x2009;&#x2264;&#x2009;500)</span>. The next line contains <span class="tex-span"><i>k</i></span> integers <span class="tex-span"><i>c</i><sub class="lower-index">1</sub>,&#x2009;<i>c</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>c</i><sub class="lower-index"><i>k</i></sub></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>c</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>n</i>)</span>. Each of the next <span class="tex-span"><i>m</i></span> lines contains three integers <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>v</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>x</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>u</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>v</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup>;&#xA0;0&#x2009;&#x2264;&#x2009;<i>x</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">4</sup>)</span>. It is guaranteed that <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/c0/14/c01479847f0e0b17e9a5ce508b4666ff5ab82fdc.png">.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If Dima&apos;s type-distribution is correct, print string &#xAB;<span class="tex-font-style-tt">Yes</span>&#xBB;, and then <span class="tex-span"><i>k</i></span> lines: in the <span class="tex-span"><i>i</i></span>-th line print integers <span class="tex-span"><i>d</i>[<i>i</i>][1],&#x2009;<i>d</i>[<i>i</i>][2],&#x2009;...,&#x2009;<i>d</i>[<i>i</i>][<i>k</i>]</span> <span class="tex-span">(<i>d</i>[<i>i</i>][<i>i</i>]&#x2009;=&#x2009;0)</span>. If there is no way to move energy from bacteria <span class="tex-span"><i>i</i></span> to bacteria <span class="tex-span"><i>j</i></span> appropriate <span class="tex-span"><i>d</i>[<i>i</i>][<i>j</i>]</span> must equal to -1. If the type-distribution isn&apos;t correct print &#xAB;<span class="tex-font-style-tt">No</span>&#xBB;.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 4 2<br>1 3<br>2 3 0<br>3 4 0<br>2 4 1<br>2 1 2<br></pre></div><div class="output"><div class="title">Output</div><pre>Yes<br>0 2<br>2 0<br></pre></div><div class="input"><div class="title">Input</div><pre>3 1 2<br>2 1<br>1 2 0<br></pre></div><div class="output"><div class="title">Output</div><pre>Yes<br>0 -1<br>-1 0<br></pre></div><div class="input"><div class="title">Input</div><pre>3 2 2<br>2 1<br>1 2 0<br>2 3 1<br></pre></div><div class="output"><div class="title">Output</div><pre>Yes<br>0 1<br>1 0<br></pre></div><div class="input"><div class="title">Input</div><pre>3 0 2<br>1 2<br></pre></div><div class="output"><div class="title">Output</div><pre>No<br></pre></div></div></div></div></div>
</div>