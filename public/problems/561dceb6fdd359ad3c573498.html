<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Solitaire</div><div class="time-limit"><div class="property-title">time limit per test</div>1.5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Vasya has a pack of <span class="tex-span">54</span> cards (<span class="tex-span">52</span> standard cards and <span class="tex-span">2</span> distinct jokers). That is all he has at the moment. Not to die from boredom, Vasya plays Solitaire with them.</p><p>Vasya lays out <span class="tex-span"><i>nm</i></span> cards as a rectangle <span class="tex-span"><i>n</i>&#x2009;&#xD7;&#x2009;<i>m</i></span>. If there are jokers among them, then Vasya should change them with some of the rest of <span class="tex-span">54&#x2009;-&#x2009;<i>nm</i></span> cards (which are not layed out) so that there were no jokers left. Vasya can pick the cards to replace the jokers arbitrarily. Remember, that each card presents in pack exactly once (i. e. <span class="tex-font-style-bf">in a single copy</span>). Vasya tries to perform the replacements so that the solitaire was <span class="tex-font-style-it">solved</span>.</p><p>Vasya thinks that the solitaire is solved if after the jokers are replaced, there exist two non-overlapping squares <span class="tex-span">3&#x2009;&#xD7;&#x2009;3</span>, inside each of which all the cards either have the same suit, or pairwise different ranks.</p><p>Determine by the initial position whether the solitaire can be solved or not. If it can be solved, show the way in which it is possible.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">3&#x2009;&#x2264;&#x2009;<i>n</i>,&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;17</span>, <span class="tex-span"><i>n</i>&#x2009;&#xD7;&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;52</span>). Next <span class="tex-span"><i>n</i></span> lines contain <span class="tex-span"><i>m</i></span> words each. Each word consists of two letters. The jokers are defined as &quot;<span class="tex-font-style-tt">J1</span>&quot; and &quot;<span class="tex-font-style-tt">J2</span>&quot; correspondingly. For the rest of the cards, the first letter stands for the rank and the second one &#x2014; for the suit. The possible ranks are: &quot;<span class="tex-font-style-tt">2</span>&quot;, &quot;<span class="tex-font-style-tt">3</span>&quot;, &quot;<span class="tex-font-style-tt">4</span>&quot;, &quot;<span class="tex-font-style-tt">5</span>&quot;, &quot;<span class="tex-font-style-tt">6</span>&quot;, &quot;<span class="tex-font-style-tt">7</span>&quot;, &quot;<span class="tex-font-style-tt">8</span>&quot;, &quot;<span class="tex-font-style-tt">9</span>&quot;, &quot;<span class="tex-font-style-tt">T</span>&quot;, &quot;<span class="tex-font-style-tt">J</span>&quot;, &quot;<span class="tex-font-style-tt">Q</span>&quot;, &quot;<span class="tex-font-style-tt">K</span>&quot; and &quot;<span class="tex-font-style-tt">A</span>&quot;. The possible suits are: &quot;<span class="tex-font-style-tt">C</span>&quot;, &quot;<span class="tex-font-style-tt">D</span>&quot;, &quot;<span class="tex-font-style-tt">H</span>&quot; and &quot;<span class="tex-font-style-tt">S</span>&quot;. All the cards are different.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If the Solitaire can be solved, print on the first line &quot;<span class="tex-font-style-tt">Solution exists.</span>&quot; without the quotes. On the second line print in what way the jokers can be replaced. Three variants are possible:</p><ul> <li> &quot;<span class="tex-font-style-tt">There are no jokers.</span>&quot;, if there are no jokers in the input data.</li><li> &quot;<span class="tex-font-style-tt">Replace J<span class="tex-span"><i>x</i></span> with <span class="tex-span"><i>y</i></span>.</span>&quot;, if there is one joker. <span class="tex-span"><i>x</i></span> is its number, and <span class="tex-span"><i>y</i></span> is the card it should be replaced with.</li><li> &quot;<span class="tex-font-style-tt">Replace J1 with <span class="tex-span"><i>x</i></span> and J2 with <span class="tex-span"><i>y</i></span>.</span>&quot;, if both jokers are present in the input data. <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> here represent distinct cards with which one should replace the first and the second jokers correspondingly.</li></ul><p>On the third line print the coordinates of the upper left corner of the first square <span class="tex-span">3&#x2009;&#xD7;&#x2009;3</span> in the format &quot;<span class="tex-font-style-tt">Put the first square to (<span class="tex-span"><i>r</i></span>, <span class="tex-span"><i>c</i></span>).</span>&quot;, where <span class="tex-span"><i>r</i></span> and <span class="tex-span"><i>c</i></span> are the row and the column correspondingly. In the same manner print on the fourth line the coordinates of the second square <span class="tex-span">3&#x2009;&#xD7;&#x2009;3</span> in the format &quot;<span class="tex-font-style-tt">Put the second square to (<span class="tex-span"><i>r</i></span>, <span class="tex-span"><i>c</i></span>).</span>&quot;.</p><p>If there are several solutions to that problem, print any of them.</p><p>If there are no solutions, print of the single line &quot;<span class="tex-font-style-tt">No solution.</span>&quot; without the quotes.</p><p>See the samples to understand the output format better.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 6<br>2S 3S 4S 7S 8S AS<br>5H 6H 7H 5S TC AC<br>8H 9H TH 7C 8C 9C<br>2D 2C 3C 4C 5C 6C<br></pre></div><div class="output"><div class="title">Output</div><pre>No solution.</pre></div><div class="input"><div class="title">Input</div><pre>4 6<br>2S 3S 4S 7S 8S AS<br>5H 6H 7H J1 TC AC<br>8H 9H TH 7C 8C 9C<br>2D 2C 3C 4C 5C 6C<br></pre></div><div class="output"><div class="title">Output</div><pre>Solution exists.<br>Replace J1 with 2H.<br>Put the first square to (1, 1).<br>Put the second square to (2, 4).<br></pre></div><div class="input"><div class="title">Input</div><pre>4 6<br>2S 3S 4S 7S 8S AS<br>5H 6H 7H QC TC AC<br>8H 9H TH 7C 8C 9C<br>2D 2C 3C 4C 5C 6C<br></pre></div><div class="output"><div class="title">Output</div><pre>Solution exists.<br>There are no jokers.<br>Put the first square to (1, 1).<br>Put the second square to (2, 4).<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>The pretests cover all the possible output formats.</p></div></div></div>
</div>