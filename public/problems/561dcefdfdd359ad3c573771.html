<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Lucky Arrays</div><div class="time-limit"><div class="property-title">time limit per test</div>4 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Little Maxim loves interesting problems. He decided to share one such problem with you. </p><p>Initially there is an array <span class="tex-span"><i>a</i></span>, consisting of <span class="tex-span"><i>n</i></span> zeroes. The elements of the array are indexed, starting from 1. Then follow queries to change array <span class="tex-span"><i>a</i></span>. Each query is characterized by two integers <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>t</i><sub class="lower-index"><i>i</i></sub></span>. In the answer to the query we should make the <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub></span>-th array element equal <span class="tex-span"><i>t</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(<i>a</i><sub class="lower-index"><i>v</i><sub class="lower-index"><i>i</i></sub></sub>&#x2009;=&#x2009;<i>t</i><sub class="lower-index"><i>i</i></sub>;&#xA0;1&#x2009;&#x2264;&#x2009;<i>v</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>n</i>)</span>.</p><p>Maxim thinks that some pairs of integers <span class="tex-span">(<i>x</i>,&#x2009;<i>y</i>)</span> are good and some are not. Maxim thinks that array <span class="tex-span"><i>a</i></span>, consisting of <span class="tex-span"><i>n</i></span> integers, is lucky, if for all integer <span class="tex-span"><i>i</i></span>, <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>i</i>&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;-&#x2009;1)</span> the pair of integers <span class="tex-span">(<i>a</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>a</i><sub class="lower-index"><i>i</i>&#x2009;+&#x2009;1</sub>)</span> &#x2014; is good. Note that the order of numbers in the pairs is important, that is, specifically, <span class="tex-span">(1,&#x2009;2)&#x2009;&#x2260;&#x2009;(2,&#x2009;1)</span>.</p><p>After each query to change array <span class="tex-span"><i>a</i></span> Maxim wants to know, how many ways there are to replace all zeroes in array <span class="tex-span"><i>a</i></span> with integers from one to three so as to make the resulting array (without zeroes) lucky. Of course, distinct zeroes can be replaced by distinct integers.</p><p>Maxim told you the sequence of queries and all pairs of integers he considers lucky. Help Maxim, solve this problem for him.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>n</i>,&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;77777)</span> &#x2014; the number of elements in the array and the number of commands.</p><p>The next three lines contain matrix <span class="tex-span"><i>w</i></span>, consisting only of zeroes and ones; the <span class="tex-span"><i>j</i></span>-th number in the <span class="tex-span"><i>i</i></span>-th of these lines &#x2014; <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i>,&#x2009;<i>j</i></sub></span>. If <span class="tex-span"><i>w</i><sub class="lower-index"><i>i</i>,&#x2009;<i>j</i></sub>&#x2009;=&#x2009;1</span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>i</i>,&#x2009;<i>j</i>&#x2009;&#x2264;&#x2009;3)</span>, then pair <span class="tex-span">(<i>i</i>,&#x2009;<i>j</i>)</span> is good, otherwise it is not good. Matrix does not have to be symmetric relative to the main diagonal.</p><p>Next <span class="tex-span"><i>m</i></span> lines contain pairs of integers <span class="tex-span"><i>v</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>t</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>v</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>n</i>,&#x2009;0&#x2009;&#x2264;&#x2009;<i>t</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;3)</span> &#x2014; the queries to change the array.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print <span class="tex-span"><i>m</i></span> integers &#x2014; the <span class="tex-span"><i>i</i></span>-th number should equal to the number of ways to replace all zeroes in array <span class="tex-span"><i>a</i></span> (changed after the <span class="tex-span"><i>i</i></span>-th query) by integers from one to three so as to make the resulting array (without zeroes) lucky. Separate the numbers by whitespaces. As the answers can be rather large, print the remainder from dividing them by <span class="tex-span">777777777</span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 10<br>1 1 0<br>1 0 0<br>1 1 1<br>1 1<br>1 3<br>2 2<br>3 0<br>2 1<br>3 0<br>3 1<br>2 0<br>3 1<br>1 0<br></pre></div><div class="output"><div class="title">Output</div><pre>3<br>6<br>1<br>1<br>2<br>2<br>1<br>3<br>3<br>6<br></pre></div></div></div></div></div>
</div>