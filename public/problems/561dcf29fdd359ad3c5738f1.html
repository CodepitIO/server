<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Dima and Kicks</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Dima is a good person. In fact, he&apos;s great. But all good things come to an end...</p><p>Seryozha is going to kick Dima just few times.. For this reason he divides the room into unit squares. Now the room is a rectangle <span class="tex-span"><i>n</i>&#x2009;&#xD7;&#x2009;<i>m</i></span> consisting of unit squares.</p><p>For the beginning, Seryozha put Dima in a center of some square. Then he started to kick Dima (it is known, that he kicks Dima at least once). Each time when Dima is kicked he flyes up and moves into one of four directions (up, left, right, down). On each move Dima passes <span class="tex-span"><i>k</i></span> <span class="tex-span">(<i>k</i>&#x2009;&gt;&#x2009;1)</span> unit of the length in the corresponding direction. Seryozha is really kind, so he kicks Dima in such way that Dima never meets the walls (in other words, Dima never leave the room&apos;s space). Seryozha is also dynamic character so Dima never flies above the same segment, connecting a pair of adjacent squares, twice.</p><p>Seryozha kicks Dima for a long time, but Dima is not vindictive &#x2014; Dima writes. Dima marked all squares in which he was staying or above which he was flying. Thanks to kicks, Dima does not remember the <span class="tex-span"><i>k</i></span> value, so he asks you to find all possible values which matches to the Dima&apos;s records.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>n</i>,&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">3</sup>)</span> &#x2014; size of the room.</p><p>Next <span class="tex-span"><i>n</i></span> lines goes, each contains <span class="tex-span"><i>m</i></span> numbers <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub></span> &#x2014; Dima&apos;s notes: <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub>&#x2009;=&#x2009;1</span>, if Dima was staying in the square <span class="tex-span">(<i>i</i>,&#x2009;<i>j</i>)</span> or was flying above it. Otherwise <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub>&#x2009;=&#x2009;0</span>.</p><p>At least one <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub></span> equals <span class="tex-span">1</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In a single line in accending order print all <span class="tex-span"><i>k</i></span> <span class="tex-span">(<i>k</i>&#x2009;&gt;&#x2009;1)</span>, which matches the Dima&apos;s notes. If there are no such <span class="tex-span"><i>k</i></span> and Dima invented this story with kicks, print -<span class="tex-span">1</span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 5<br>1 1 1 1 1<br>1 0 0 0 1<br>1 0 0 0 1<br>1 0 0 0 1<br>1 1 1 1 1<br></pre></div><div class="output"><div class="title">Output</div><pre>2 4<br></pre></div><div class="input"><div class="title">Input</div><pre>7 7<br>0 0 1 1 1 0 0<br>0 0 1 0 1 0 0<br>1 1 1 1 1 1 1<br>1 0 1 0 1 0 1<br>1 1 1 1 1 1 1<br>0 0 1 0 1 0 0<br>0 0 1 1 1 0 0<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br></pre></div><div class="input"><div class="title">Input</div><pre>3 3<br>1 1 1<br>1 1 1<br>1 1 1<br></pre></div><div class="output"><div class="title">Output</div><pre>-1<br></pre></div><div class="input"><div class="title">Input</div><pre>4 4<br>1 1 1 1<br>0 0 0 0<br>0 0 0 0<br>0 0 0 0<br></pre></div><div class="output"><div class="title">Output</div><pre>3<br></pre></div><div class="input"><div class="title">Input</div><pre>5 5<br>0 0 1 0 0<br>0 0 1 0 0<br>1 1 1 1 1<br>0 0 1 0 0<br>0 0 1 0 0<br></pre></div><div class="output"><div class="title">Output</div><pre>-1<br></pre></div></div></div></div></div>
</div>