<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Spider</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>A plane contains a not necessarily convex polygon without self-intersections, consisting of <span class="tex-span"><i>n</i></span> vertexes, numbered from 1 to <span class="tex-span"><i>n</i></span>. There is a spider sitting on the border of the polygon, the spider can move like that:</p><ol> <li> <span class="tex-font-style-it">Transfer.</span> The spider moves from the point <span class="tex-span"><i>p</i><sub class="lower-index">1</sub></span> with coordinates <span class="tex-span">(<i>x</i><sub class="lower-index">1</sub>,&#x2009;<i>y</i><sub class="lower-index">1</sub>)</span>, lying on the polygon border, to the point <span class="tex-span"><i>p</i><sub class="lower-index">2</sub></span> with coordinates <span class="tex-span">(<i>x</i><sub class="lower-index">2</sub>,&#x2009;<i>y</i><sub class="lower-index">2</sub>)</span>, also lying on the border. The spider can&apos;t go beyond the polygon border as it transfers, that is, the spider&apos;s path from point <span class="tex-span"><i>p</i><sub class="lower-index">1</sub></span> to point <span class="tex-span"><i>p</i><sub class="lower-index">2</sub></span> goes along the polygon border. It&apos;s up to the spider to choose the direction of walking round the polygon border (clockwise or counterclockwise). </li><li> <span class="tex-font-style-it">Descend.</span> The spider moves from point <span class="tex-span"><i>p</i><sub class="lower-index">1</sub></span> with coordinates <span class="tex-span">(<i>x</i><sub class="lower-index">1</sub>,&#x2009;<i>y</i><sub class="lower-index">1</sub>)</span> to point <span class="tex-span"><i>p</i><sub class="lower-index">2</sub></span> with coordinates <span class="tex-span">(<i>x</i><sub class="lower-index">2</sub>,&#x2009;<i>y</i><sub class="lower-index">2</sub>)</span>, at that points <span class="tex-span"><i>p</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>p</i><sub class="lower-index">2</sub></span> must lie on one vertical straight line (<span class="tex-span"><i>x</i><sub class="lower-index">1</sub>&#x2009;=&#x2009;<i>x</i><sub class="lower-index">2</sub></span>), point <span class="tex-span"><i>p</i><sub class="lower-index">1</sub></span> must be not lower than point <span class="tex-span"><i>p</i><sub class="lower-index">2</sub></span> (<span class="tex-span"><i>y</i><sub class="lower-index">1</sub>&#x2009;&#x2265;&#x2009;<i>y</i><sub class="lower-index">2</sub></span>) and segment <span class="tex-span"><i>p</i><sub class="lower-index">1</sub><i>p</i><sub class="lower-index">2</sub></span> mustn&apos;t have points, located strictly outside the polygon (specifically, the segment can have common points with the border). </li></ol><p>Initially the spider is located at the polygon vertex with number <span class="tex-span"><i>s</i></span>. Find the length of the shortest path to the vertex number <span class="tex-span"><i>t</i></span>, consisting of transfers and descends. The distance is determined by the usual Euclidean metric <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/55/5b/555b98a9af424f8408fe8e627d2518286b95673c.png">.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">3&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup></span>) &#x2014; the number of vertexes of the given polygon. Next <span class="tex-span"><i>n</i></span> lines contain two space-separated integers each &#x2014; the coordinates of the polygon vertexes. The vertexes are listed in the counter-clockwise order. The coordinates of the polygon vertexes do not exceed <span class="tex-span">10<sup class="upper-index">4</sup></span> in their absolute value. </p><p>The last line contains two space-separated integers <span class="tex-span"><i>s</i></span> and <span class="tex-span"><i>t</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>s</i>,&#x2009;<i>t</i>&#x2009;&#x2264;&#x2009;<i>n</i></span>) &#x2014; the start and the end vertexes of the sought shortest way. </p><p>Consider the polygon vertexes numbered in the order they are given in the input, that is, the coordinates of the first vertex are located on the second line of the input and the coordinates of the <span class="tex-span"><i>n</i></span>-th vertex are on the <span class="tex-span">(<i>n</i>&#x2009;+&#x2009;1)</span>-th line. It is guaranteed that the given polygon is simple, that is, it contains no self-intersections or self-tangencies.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the output print a single real number &#x2014; the length of the shortest way from vertex <span class="tex-span"><i>s</i></span> to vertex <span class="tex-span"><i>t</i></span>. The answer is considered correct, if its absolute or relative error does not exceed <span class="tex-span">10<sup class="upper-index">&#x2009;-&#x2009;6</sup></span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br>0 0<br>1 0<br>1 1<br>0 1<br>1 4<br></pre></div><div class="output"><div class="title">Output</div><pre>1.000000000000000000e+000<br></pre></div><div class="input"><div class="title">Input</div><pre>4<br>0 0<br>1 1<br>0 2<br>-1 1<br>3 3<br></pre></div><div class="output"><div class="title">Output</div><pre>0.000000000000000000e+000<br></pre></div><div class="input"><div class="title">Input</div><pre>5<br>0 0<br>5 0<br>1 4<br>0 2<br>2 1<br>3 1<br></pre></div><div class="output"><div class="title">Output</div><pre>5.650281539872884700e+000<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample the spider transfers along the side that connects vertexes 1 and 4.</p><p>In the second sample the spider doesn&apos;t have to transfer anywhere, so the distance equals zero.</p><p>In the third sample the best strategy for the spider is to transfer from vertex 3 to point (2,3), descend to point (2,1), and then transfer to vertex 1.</p></div></div></div>
</div>