<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Common ancestor</div><div class="time-limit"><div class="property-title">time limit per test</div>5 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The DNA sequence for every living creature in Berland can be represented as a non-empty line consisting of lowercase Latin letters. Berland scientists found out that all the creatures evolve by stages. During one stage exactly one symbol of the DNA line is replaced by exactly two other ones. At that overall there are <span class="tex-span"><i>n</i></span> permissible substitutions. The substitution <span class="tex-font-style-tt"><span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>-&gt;<span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub><i>c</i><sub class="lower-index"><i>i</i></sub></span></span> means that any <span class="tex-font-style-bf">one</span> symbol <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> can be replaced with two symbols <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub><i>c</i><sub class="lower-index"><i>i</i></sub></span>. Every substitution could happen an unlimited number of times.</p><p>They say that two creatures with DNA sequences <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span> can have a common ancestor if there exists such a DNA sequence <span class="tex-span"><i>s</i><sub class="lower-index">3</sub></span> that throughout evolution it can result in <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span>, perhaps after a different number of stages. Your task is to find out by the given <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span> whether the creatures possessing such DNA sequences can have a common ancestor. If the answer is positive, you have to find the length of the shortest sequence of the common ancestor&#x2019;s DNA.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a non-empty DNA sequence <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span>, the second line contains a non-empty DNA sequence <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span>. The lengths of these lines do not exceed 50, the lines contain only lowercase Latin letters. The third line contains an integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">0&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;50</span>) &#x2014; the number of permissible substitutions. Then follow <span class="tex-span"><i>n</i></span> lines each of which describes a substitution in the format <span class="tex-font-style-tt"><span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>-&gt;<span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub><i>c</i><sub class="lower-index"><i>i</i></sub></span></span>. The characters <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>, and <span class="tex-span"><i>c</i><sub class="lower-index"><i>i</i></sub></span> are lowercase Latin letters. Lines <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span> can coincide, the list of substitutions can contain similar substitutions.</p></div><div class="output-specification"><div class="section-title">Output</div><p>If <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span> cannot have a common ancestor, print -1. Otherwise print the length of the shortest sequence <span class="tex-span"><i>s</i><sub class="lower-index">3</sub></span>, from which <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> and <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span> could have evolved.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>ababa<br>aba<br>2<br>c-&gt;ba<br>c-&gt;cc<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br></pre></div><div class="input"><div class="title">Input</div><pre>ababa<br>aba<br>7<br>c-&gt;ba<br>c-&gt;cc<br>e-&gt;ab<br>z-&gt;ea<br>b-&gt;ba<br>d-&gt;dd<br>d-&gt;ab<br></pre></div><div class="output"><div class="title">Output</div><pre>1<br></pre></div><div class="input"><div class="title">Input</div><pre>ababa<br>aba<br>1<br>c-&gt;ba<br></pre></div><div class="output"><div class="title">Output</div><pre>-1<br></pre></div></div></div></div></div>
</div>