<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Drawing Circles is Fun</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>There are a set of points <span class="tex-span"><i>S</i></span> on the plane. This set doesn&apos;t contain the origin <span class="tex-span"><i>O</i>(0,&#x2009;0)</span>, and for each two distinct points in the set <span class="tex-span"><i>A</i></span> and <span class="tex-span"><i>B</i></span>, the triangle <span class="tex-span"><i>OAB</i></span> has strictly positive area.</p><p>Consider a set of pairs of points <span class="tex-span">(<i>P</i><sub class="lower-index">1</sub>,&#x2009;<i>P</i><sub class="lower-index">2</sub>),&#x2009;(<i>P</i><sub class="lower-index">3</sub>,&#x2009;<i>P</i><sub class="lower-index">4</sub>),&#x2009;...,&#x2009;(<i>P</i><sub class="lower-index">2<i>k</i>&#x2009;-&#x2009;1</sub>,&#x2009;<i>P</i><sub class="lower-index">2<i>k</i></sub>)</span>. We&apos;ll call the set <span class="tex-font-style-it">good</span> if and only if:</p><ul> <li> <span class="tex-span"><i>k</i>&#x2009;&#x2265;&#x2009;2</span>. </li><li> All <span class="tex-span"><i>P</i><sub class="lower-index"><i>i</i></sub></span> are distinct, and each <span class="tex-span"><i>P</i><sub class="lower-index"><i>i</i></sub></span> is an element of <span class="tex-span"><i>S</i></span>. </li><li> For any two pairs <span class="tex-span">(<i>P</i><sub class="lower-index">2<i>i</i>&#x2009;-&#x2009;1</sub>,&#x2009;<i>P</i><sub class="lower-index">2<i>i</i></sub>)</span> and <span class="tex-span">(<i>P</i><sub class="lower-index">2<i>j</i>&#x2009;-&#x2009;1</sub>,&#x2009;<i>P</i><sub class="lower-index">2<i>j</i></sub>)</span>, the circumcircles of triangles <span class="tex-span"><i>OP</i><sub class="lower-index">2<i>i</i>&#x2009;-&#x2009;1</sub><i>P</i><sub class="lower-index">2<i>j</i>&#x2009;-&#x2009;1</sub></span> and <span class="tex-span"><i>OP</i><sub class="lower-index">2<i>i</i></sub><i>P</i><sub class="lower-index">2<i>j</i></sub></span> have a single common point, and the circumcircle of triangles <span class="tex-span"><i>OP</i><sub class="lower-index">2<i>i</i>&#x2009;-&#x2009;1</sub><i>P</i><sub class="lower-index">2<i>j</i></sub></span> and <span class="tex-span"><i>OP</i><sub class="lower-index">2<i>i</i></sub><i>P</i><sub class="lower-index">2<i>j</i>&#x2009;-&#x2009;1</sub></span> have a single common point. </li></ul><p>Calculate the number of good sets of pairs modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup>&#x2009;+&#x2009;7)</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains a single integer <span class="tex-span"><i>n</i></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;1000)</span> &#x2014; the number of points in <span class="tex-span"><i>S</i></span>. Each of the next <span class="tex-span"><i>n</i></span> lines contains four integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>b</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>c</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>d</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(0&#x2009;&#x2264;&#x2009;|<i>a</i><sub class="lower-index"><i>i</i></sub>|,&#x2009;|<i>c</i><sub class="lower-index"><i>i</i></sub>|&#x2009;&#x2264;&#x2009;50;&#xA0;1&#x2009;&#x2264;&#x2009;<i>b</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>d</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;50;&#xA0;(<i>a</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>c</i><sub class="lower-index"><i>i</i></sub>)&#x2009;&#x2260;&#x2009;(0,&#x2009;0))</span>. These integers represent a point <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/ea/fa/eafaaeb1ddb3167cde87368bb6820a2be1b18339.png">.</p><p>No two points coincide.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single integer &#x2014; the answer to the problem modulo <span class="tex-span">1000000007</span> <span class="tex-span">(10<sup class="upper-index">9</sup>&#x2009;+&#x2009;7)</span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>10<br>-46 46 0 36<br>0 20 -24 48<br>-50 50 -49 49<br>-20 50 8 40<br>-15 30 14 28<br>4 10 -4 5<br>6 15 8 10<br>-20 50 -3 15<br>4 34 -16 34<br>16 34 2 17<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br></pre></div><div class="input"><div class="title">Input</div><pre>10<br>30 30 -26 26<br>0 15 -36 36<br>-28 28 -34 34<br>10 10 0 4<br>-8 20 40 50<br>9 45 12 30<br>6 15 7 35<br>36 45 -8 20<br>-16 34 -4 34<br>4 34 8 17<br></pre></div><div class="output"><div class="title">Output</div><pre>4<br></pre></div><div class="input"><div class="title">Input</div><pre>10<br>0 20 38 38<br>-30 30 -13 13<br>-11 11 16 16<br>30 30 0 37<br>6 30 -4 10<br>6 15 12 15<br>-4 5 -10 25<br>-16 20 4 10<br>8 17 -2 17<br>16 34 2 17<br></pre></div><div class="output"><div class="title">Output</div><pre>10<br></pre></div></div></div></div></div>
</div>