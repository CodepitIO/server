<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Cubes</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Once Vasya and Petya assembled a figure of <span class="tex-span"><i>m</i></span> cubes, each of them is associated with a number between <span class="tex-span">0</span> and <span class="tex-span"><i>m</i>&#x2009;-&#x2009;1</span> (inclusive, each number appeared exactly once). Let&apos;s consider a coordinate system such that the <span class="tex-span"><i>OX</i></span> is the ground, and the <span class="tex-span"><i>OY</i></span> is directed upwards. Each cube is associated with the coordinates of its lower left corner, these coordinates are integers for each cube.</p><p>The figure turned out to be <span class="tex-font-style-it">stable</span>. This means that for any cube that is not on the ground, there is at least one cube under it such that those two cubes touch <span class="tex-font-style-bf">by a side or a corner</span>. More formally, this means that for the cube with coordinates <span class="tex-span">(<i>x</i>,&#x2009;<i>y</i>)</span> either <span class="tex-span"><i>y</i>&#x2009;=&#x2009;0</span>, or there is a cube with coordinates <span class="tex-span">(<i>x</i>&#x2009;-&#x2009;1,&#x2009;<i>y</i>&#x2009;-&#x2009;1)</span>, <span class="tex-span">(<i>x</i>,&#x2009;<i>y</i>&#x2009;-&#x2009;1)</span> or <span class="tex-span">(<i>x</i>&#x2009;+&#x2009;1,&#x2009;<i>y</i>&#x2009;-&#x2009;1)</span>.</p><p>Now the boys want to disassemble the figure and put all the cubes in a row. In one step the cube is removed from the figure and being put to the right of the blocks that have already been laid. The guys remove the cubes in such order that the figure remains stable. To make the process more interesting, the guys decided to play the following game. The guys take out the cubes from the figure in turns. It is easy to see that after the figure is disassembled, the integers written on the cubes form a number, written in the <span class="tex-span"><i>m</i></span>-ary positional numerical system (possibly, with a leading zero). Vasya wants the resulting number to be maximum possible, and Petya, on the contrary, tries to make it as small as possible. Vasya starts the game.</p><p>Your task is to determine what number is formed after the figure is disassembled, if the boys play optimally. Determine the remainder of the answer modulo <span class="tex-span">10<sup class="upper-index">9</sup>&#x2009;+&#x2009;9</span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains number <span class="tex-span"><i>m</i></span> (<span class="tex-span">2&#x2009;&#x2264;&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup></span>).</p><p>The following <span class="tex-span"><i>m</i></span> lines contain the coordinates of the cubes <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>y</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">&#x2009;-&#x2009;10<sup class="upper-index">9</sup>&#x2009;&#x2264;&#x2009;<i>x</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">9</sup></span>, <span class="tex-span">0&#x2009;&#x2264;&#x2009;<i>y</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">9</sup></span>) in ascending order of numbers written on them. It is guaranteed that the original figure is stable.</p><p>No two cubes occupy the same place.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the only line print the answer to the problem.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br>2 1<br>1 0<br>0 1<br></pre></div><div class="output"><div class="title">Output</div><pre>19<br></pre></div><div class="input"><div class="title">Input</div><pre>5<br>0 0<br>0 1<br>0 2<br>0 3<br>0 4<br></pre></div><div class="output"><div class="title">Output</div><pre>2930<br></pre></div></div></div></div></div>
</div>