<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Robot in Basement</div><div class="time-limit"><div class="property-title">time limit per test</div>4 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>The Professor has lost his home robot yet again. After some thinking Professor understood that he had left the robot in the basement.</p><p>The basement in Professor&apos;s house is represented by a rectangle <span class="tex-span"><i>n</i>&#x2009;&#xD7;&#x2009;<i>m</i></span>, split into <span class="tex-span">1&#x2009;&#xD7;&#x2009;1</span> squares. Some squares are walls which are impassable; other squares are passable. You can get from any passable square to any other passable square moving through edge-adjacent passable squares. One passable square is the exit from the basement. The robot is placed exactly in one passable square. Also the robot may be placed in the exit square.</p><p>Professor is scared of going to the dark basement looking for the robot at night. However, he has a basement plan and the robot&apos;s remote control. Using the remote, Professor can send signals to the robot to shift one square left, right, up or down. When the robot receives a signal, it moves in the required direction if the robot&apos;s neighboring square in the given direction is passable. Otherwise, the robot stays idle.</p><p>Professor wrote a sequence of <span class="tex-span"><i>k</i></span> commands on a piece of paper. He thinks that the sequence can lead the robot out of the basement, wherever it&apos;s initial position might be. Professor programmed another robot to press the required buttons on the remote according to the notes on the piece of paper. Professor was just about to run the program and go to bed, when he had an epiphany.</p><p>Executing each command takes some energy and Professor doesn&apos;t want to get huge electricity bill at the end of the month. That&apos;s why he wants to find in the sequence he has written out the minimal possible prefix that would guarantee to lead the robot out to the exit after the prefix is fulfilled. And that&apos;s the problem Professor challenges you with at this late hour.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">3&#x2009;&#x2264;&#x2009;<i>n</i>,&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;150</span>, <span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>k</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup></span>). Next <span class="tex-span"><i>n</i></span> lines contain <span class="tex-span"><i>m</i></span> characters each &#x2014; that is the Professor&apos;s basement&apos;s description: &quot;<span class="tex-font-style-tt">#</span>&quot; stands for a wall, &quot;<span class="tex-font-style-tt">.</span>&quot; stands for a passable square and &quot;<span class="tex-font-style-tt">E</span>&quot; stands for the exit from the basement (this square also is passable). It is possible to get from each passable square to the exit, all squares located by the <span class="tex-span"><i>n</i>&#x2009;&#xD7;&#x2009;<i>m</i></span> rectangle&apos;s perimeter are the walls. Exactly one square is the exit from the basement. The last line contains <span class="tex-span"><i>k</i></span> characters, the description of the sequence of commands that Professor has written out on a piece of paper. &quot;<span class="tex-font-style-tt">L</span>&quot;, &quot;<span class="tex-font-style-tt">R</span>&quot;, &quot;<span class="tex-font-style-tt">U</span>&quot;, &quot;<span class="tex-font-style-tt">D</span>&quot; stand for commands left, right, up and down correspondingly.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print in the output file the length of the smallest possible prefix that will lead the robot to the exit square. In other words, wherever the robot had been positioned initially, it should be positioned in the exit square <span class="tex-font-style-bf">after all</span> the commands from the prefix are fulfilled (during doing commands the robot can come and leave the exit square, but only the last position of the robot is interesting for us). If Professor is mistaken and no prefix (including the whole sequence) can bring the robot to the exit, print &quot;-1&quot; (without the quotes). If there is the only passable square and it is the exit, print &quot;0&quot; (without the quotes).</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 5 7<br>#####<br>#...#<br>#...#<br>#E..#<br>#####<br>UULLDDR<br></pre></div><div class="output"><div class="title">Output</div><pre>6<br></pre></div><div class="input"><div class="title">Input</div><pre>5 5 7<br>#####<br>#.#.#<br>#...#<br>#E..#<br>#####<br>UULLDDR<br></pre></div><div class="output"><div class="title">Output</div><pre>-1<br></pre></div><div class="input"><div class="title">Input</div><pre>5 3 2<br>###<br>#.#<br>#.#<br>#E#<br>###<br>DD<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br></pre></div></div></div></div></div>
</div>