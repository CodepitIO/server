<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Breaking Good</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Breaking Good is a new video game which a lot of gamers want to have. There is a certain level in the game that is really difficult even for experienced gamers.</p><p>Walter William, the main character of the game, wants to join a gang called Los Hermanos (The Brothers). The gang controls the whole country which consists of <span class="tex-span"><i>n</i></span> cities with <span class="tex-span"><i>m</i></span> bidirectional roads connecting them. There is no road is connecting a city to itself and for any two cities there is at most one road between them. The country is connected, in the other words, it is possible to reach any city from any other city using the given roads. </p><p>The roads aren&apos;t all working. There are some roads which need some more work to be performed to be completely functioning.</p><p>The gang is going to rob a bank! The bank is located in city <span class="tex-span">1</span>. As usual, the hardest part is to escape to their headquarters where the police can&apos;t get them. The gang&apos;s headquarters is in city <span class="tex-span"><i>n</i></span>. To gain the gang&apos;s trust, Walter is in charge of this operation, so he came up with a smart plan.</p><p>First of all the path which they are going to use on their way back from city <span class="tex-span">1</span> to their headquarters <span class="tex-span"><i>n</i></span> must be <span class="tex-font-style-it">as short as possible</span>, since it is important to finish operation as fast as possible.</p><p>Then, gang has to blow up all other roads in country that don&apos;t lay on this path, in order to prevent any police reinforcements. In case of non-working road, they don&apos;t have to blow up it as it is already malfunctional. </p><p>If the chosen path has some roads that doesn&apos;t work they&apos;ll have to repair those roads before the operation.</p><p>Walter discovered that there was a lot of paths that satisfied the condition of being shortest possible so he decided to choose among them a path that minimizes the total number of affected roads (both roads that have to be blown up and roads to be repaired).</p><p>Can you help Walter complete his task and gain the gang&apos;s trust?</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains two integers <span class="tex-span"><i>n</i>,&#x2009;<i>m</i></span> (<span class="tex-span">2&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup></span>, <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/5e/93/5e93dd0fc8c5391209d3f077e1cd121822fe2db2.png">), the number of cities and number of roads respectively.</p><p>In following <span class="tex-span"><i>m</i></span> lines there are descriptions of roads. Each description consists of three integers <span class="tex-span"><i>x</i>,&#x2009;<i>y</i>,&#x2009;<i>z</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>x</i>,&#x2009;<i>y</i>&#x2009;&#x2264;&#x2009;<i>n</i></span>, <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/e8/55/e855449a29834e1a90d95f1147559333607ba76c.png">) meaning that there is a road connecting cities number <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span>. If <span class="tex-span"><i>z</i>&#x2009;=&#x2009;1</span>, this road is working, otherwise it is not.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line output one integer <span class="tex-span"><i>k</i></span>, the minimum possible number of roads affected by gang.</p><p>In the following <span class="tex-span"><i>k</i></span> lines output three integers describing roads that should be affected. Each line should contain three integers <span class="tex-span"><i>x</i>,&#x2009;<i>y</i>,&#x2009;<i>z</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>x</i>,&#x2009;<i>y</i>&#x2009;&#x2264;&#x2009;<i>n</i></span>, <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/e8/55/e855449a29834e1a90d95f1147559333607ba76c.png">), cities connected by a road and the new state of a road. <span class="tex-span"><i>z</i>&#x2009;=&#x2009;1</span> indicates that the road between cities <span class="tex-span"><i>x</i></span> and <span class="tex-span"><i>y</i></span> should be repaired and <span class="tex-span"><i>z</i>&#x2009;=&#x2009;0</span> means that road should be blown up. </p><p>You may output roads in any order. Each affected road should appear exactly once. You may output cities connected by a single road in any order. If you output a road, it&apos;s original state should be different from <span class="tex-span"><i>z</i></span>.</p><p>After performing all operations accroding to your plan, there should remain working only roads lying on some certain shortest past between city <span class="tex-span">1</span> and <span class="tex-span"><i>n</i></span>.</p><p>If there are multiple optimal answers output any.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>2 1<br>1 2 0<br></pre></div><div class="output"><div class="title">Output</div><pre>1<br>1 2 1<br></pre></div><div class="input"><div class="title">Input</div><pre>4 4<br>1 2 1<br>1 3 0<br>2 3 1<br>3 4 1<br></pre></div><div class="output"><div class="title">Output</div><pre>3<br>1 2 0<br>1 3 1<br>2 3 0<br></pre></div><div class="input"><div class="title">Input</div><pre>8 9<br>1 2 0<br>8 3 0<br>2 3 1<br>1 4 1<br>8 7 0<br>1 5 1<br>4 6 1<br>5 7 0<br>6 8 0<br></pre></div><div class="output"><div class="title">Output</div><pre>3<br>2 3 0<br>1 5 0<br>6 8 1<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first test the only path is <span class="tex-span">1&#x2009;-&#x2009;2</span></p><p>In the second test the only shortest path is <span class="tex-span">1&#x2009;-&#x2009;3&#x2009;-&#x2009;4</span></p><p>In the third test there are multiple shortest paths but the optimal is <span class="tex-span">1&#x2009;-&#x2009;4&#x2009;-&#x2009;6&#x2009;-&#x2009;8</span></p></div></div></div>
</div>