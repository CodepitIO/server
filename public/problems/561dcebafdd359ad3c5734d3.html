<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Information Reform</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Thought it is already the XXI century, the Mass Media isn&apos;t very popular in Walrusland. The cities get news from messengers who can only travel along roads. The network of roads in Walrusland is built so that it is possible to get to any city from any other one in exactly one way, and the roads&apos; lengths are equal.</p><p>The North Pole governor decided to carry out an information reform. Several cities were decided to be chosen and made regional centers. Maintaining a region center takes <span class="tex-span"><i>k</i></span> fishlars (which is a local currency) per year. It is assumed that a regional center always has information on the latest news.</p><p>For every city which is not a regional center, it was decided to appoint a regional center which will be responsible for keeping this city informed. In that case the maintenance costs will be equal to <span class="tex-span"><i>d</i><sub class="lower-index"><i>len</i></sub></span> fishlars per year, where <span class="tex-span"><i>len</i></span> is the distance from a city to the corresponding regional center, measured in the number of roads along which one needs to go.</p><p>Your task is to minimize the costs to carry out the reform.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two given numbers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;180,&#x2009;1&#x2009;&#x2264;&#x2009;<i>k</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup></span>).</p><p>The second line contains <span class="tex-span"><i>n</i>&#x2009;-&#x2009;1</span> integers <span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub></span>, numbered starting with 1 (<span class="tex-span"><i>d</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>d</i><sub class="lower-index"><i>i</i>&#x2009;+&#x2009;1</sub>,&#x2009;0&#x2009;&#x2264;&#x2009;<i>d</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup></span>).</p><p>Next <span class="tex-span"><i>n</i>&#x2009;-&#x2009;1</span> lines contain the pairs of cities connected by a road.</p></div><div class="output-specification"><div class="section-title">Output</div><p>On the first line print the minimum number of fishlars needed for a year&apos;s maintenance. On the second line print <span class="tex-span"><i>n</i></span> numbers, where the <span class="tex-span"><i>i</i></span>-th number will represent the number of the regional center, appointed to the <span class="tex-span"><i>i</i></span>-th city. If the <span class="tex-span"><i>i</i></span>-th city is a regional center itself, then you should print number <span class="tex-span"><i>i</i></span>.</p><p>If there are several solutions to that problem, print any of them.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>8 10<br>2 5 9 11 15 19 20<br>1 4<br>1 3<br>1 7<br>4 6<br>2 8<br>2 3<br>3 5<br></pre></div><div class="output"><div class="title">Output</div><pre>38<br>3 3 3 4 3 4 3 3 </pre></div></div></div></div></div>
</div>