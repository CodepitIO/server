<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Wizards and Bets</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>In some country live wizards. They like to make weird bets.</p><p>Two wizards draw an acyclic directed graph with <span class="tex-span"><i>n</i></span> vertices and <span class="tex-span"><i>m</i></span> edges (the graph&apos;s vertices are numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>). A <span class="tex-font-style-it">source</span> is a vertex with no incoming edges, and a <span class="tex-font-style-it">sink</span> is the vertex with no outgoing edges. Note that a vertex could be the sink and the source simultaneously. In the wizards&apos; graph the number of the sinks and the sources is the same.</p><p>Wizards numbered the sources in the order of increasing numbers of the vertices from <span class="tex-span">1</span> to <span class="tex-span"><i>k</i></span>. The sinks are numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>k</i></span> in the similar way.</p><p>To make a bet, they, as are real wizards, cast a spell, which selects a set of <span class="tex-span"><i>k</i></span> paths from all sources to the sinks in such a way that no two paths intersect at the vertices. In this case, each sink has exactly one path going to it from exactly one source. Let&apos;s suppose that the <span class="tex-span"><i>i</i></span>-th sink has a path going to it from the <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span>&apos;s source. Then let&apos;s call pair <span class="tex-span">(<i>i</i>,&#x2009;<i>j</i>)</span> an <span class="tex-font-style-it">inversion</span> if <span class="tex-span"><i>i</i>&#x2009;&lt;&#x2009;<i>j</i></span> and <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>&#x2009;&gt;&#x2009;<i>a</i><sub class="lower-index"><i>j</i></sub></span>. If the number of inversions among all possible pairs <span class="tex-span">(<i>i</i>,&#x2009;<i>j</i>)</span>, such that <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>i</i>&#x2009;&lt;&#x2009;<i>j</i>&#x2009;&#x2264;&#x2009;<i>k</i>)</span>, is even, then the first wizard wins (the second one gives him one magic coin). Otherwise, the second wizard wins (he gets one magic coin from the first one).</p><p>Our wizards are captured with feverish excitement, so they kept choosing new paths again and again for so long that eventually they have chosen every possible set of paths for exactly once. The two sets of non-intersecting pathes are considered to be different, if and only if there is an edge, which lies at some path in one set and doesn&apos;t lie at any path of another set. To check their notes, they asked you to count the total winnings of the first player for all possible sets of paths modulo a prime number <span class="tex-span"><i>p</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains three space-separated integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>p</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;600</span>, <span class="tex-span">0&#x2009;&#x2264;&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup></span>, <span class="tex-span">2&#x2009;&#x2264;&#x2009;<i>p</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">9</sup>&#x2009;+&#x2009;7</span>). It is guaranteed that <span class="tex-span"><i>p</i></span> is prime number.</p><p>Next <span class="tex-span"><i>m</i></span> lines contain edges of the graph. Each line contains a pair of space-separated integers, <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub>&#xA0;<i>b</i><sub class="lower-index"><i>i</i></sub></span> &#x2014; an edge from vertex <span class="tex-span"><i>a</i><sub class="lower-index"><i>i</i></sub></span> to vertex <span class="tex-span"><i>b</i><sub class="lower-index"><i>i</i></sub></span>. It is guaranteed that the graph is acyclic and that the graph contains the same number of sources and sinks. Please note that the graph can have multiple edges.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the answer to the problem &#x2014; the total winnings of the first player modulo a prime number <span class="tex-span"><i>p</i></span>. Please note that the winnings may be negative, but the modulo residue must be non-negative (see the sample).</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 2 1000003<br>1 3<br>2 4<br></pre></div><div class="output"><div class="title">Output</div><pre>1<br></pre></div><div class="input"><div class="title">Input</div><pre>4 2 1000003<br>4 1<br>3 2<br></pre></div><div class="output"><div class="title">Output</div><pre>1000002<br></pre></div><div class="input"><div class="title">Input</div><pre>4 4 1000003<br>2 1<br>2 4<br>3 1<br>3 4<br></pre></div><div class="output"><div class="title">Output</div><pre>0<br></pre></div><div class="input"><div class="title">Input</div><pre>6 5 1000003<br>1 4<br>1 5<br>1 6<br>2 6<br>3 6<br></pre></div><div class="output"><div class="title">Output</div><pre>0<br></pre></div><div class="input"><div class="title">Input</div><pre>5 2 1000003<br>5 1<br>3 4<br></pre></div><div class="output"><div class="title">Output</div><pre>1<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first sample, there is exactly one set of paths &#x2014; <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/59/21/5921fcc4548e9ce1a5d3d51152f8b64d011aa2fa.png">. The number of inversions is 0, which is an even number. Therefore, the first wizard gets 1 coin.</p><p>In the second sample there is exactly one set of paths &#x2014; <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/d0/0f/d00fd2c628faaf23b665ce0c10e215cd3d6f15e0.png">. There is exactly one inversion. Therefore, the first wizard gets -1 coin. <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/25/89/2589784107398d31793a3a5cc23a5492f188ffbf.png">.</p><p>In the third sample, there are two sets of paths, which are counted with opposite signs.</p><p>In the fourth sample there are no set of paths at all.</p><p>In the fifth sample, there are three sources &#x2014; the vertices with the numbers (2, 3, 5) and three sinks &#x2014; the vertices with numbers (1, 2, 4). For a single set of paths <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/38/b2/38b2cafbabb1d27762453f529b9140f8d140424c.png"> are 2 inversions, that is, their number is <span class="tex-font-style-bf">even</span>.</p></div></div></div>
</div>