<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Two Subsequences</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>On an IT lesson Valera studied data compression. The teacher told about a new method, which we shall now describe to you.</p><p>Let <span class="tex-span">{<i>a</i><sub class="lower-index">1</sub>,&#x2009;<i>a</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>a</i><sub class="lower-index"><i>n</i></sub>}</span> be the given sequence of lines needed to be compressed. Here and below we shall assume that all lines are <span class="tex-font-style-bf">of the same length</span> and consist only of the digits <span class="tex-span">0</span> and <span class="tex-span">1</span>. Let&apos;s define the compression function:</p><ul> <li> <span class="tex-span"><i>f</i>(</span>empty sequence<span class="tex-span">)&#x2009;=&#x2009;</span>empty string </li><li> <span class="tex-span"><i>f</i>(<i>s</i>)&#x2009;=&#x2009;<i>s</i></span>. </li><li> <span class="tex-span"><i>f</i>(<i>s</i><sub class="lower-index">1</sub>,&#x2009;<i>s</i><sub class="lower-index">2</sub>)&#x2009;=&#x2009;</span> the smallest in length string, which has one of the prefixes equal to <span class="tex-span"><i>s</i><sub class="lower-index">1</sub></span> and one of the suffixes equal to <span class="tex-span"><i>s</i><sub class="lower-index">2</sub></span>. For example, <span class="tex-span"><i>f</i>(001,&#x2009;011)&#x2009;=&#x2009;0011</span>, <span class="tex-span"><i>f</i>(111,&#x2009;011)&#x2009;=&#x2009;111011</span>. </li><li> <span class="tex-span"><i>f</i>(<i>a</i><sub class="lower-index">1</sub>,&#x2009;<i>a</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>a</i><sub class="lower-index"><i>n</i></sub>)&#x2009;=&#x2009;<i>f</i>(<i>f</i>(<i>a</i><sub class="lower-index">1</sub>,&#x2009;<i>a</i><sub class="lower-index">2</sub>,&#x2009;<i>a</i><sub class="lower-index"><i>n</i>&#x2009;-&#x2009;1</sub>),&#x2009;<i>a</i><sub class="lower-index"><i>n</i></sub>)</span>. For example, <span class="tex-span"><i>f</i>(000,&#x2009;000,&#x2009;111)&#x2009;=&#x2009;<i>f</i>(<i>f</i>(000,&#x2009;000),&#x2009;111)&#x2009;=&#x2009;<i>f</i>(000,&#x2009;111)&#x2009;=&#x2009;000111</span>. </li></ul><p>Valera faces a real challenge: he should divide the given sequence <span class="tex-span">{<i>a</i><sub class="lower-index">1</sub>,&#x2009;<i>a</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>a</i><sub class="lower-index"><i>n</i></sub>}</span> into two subsequences <span class="tex-span">{<i>b</i><sub class="lower-index">1</sub>,&#x2009;<i>b</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>b</i><sub class="lower-index"><i>k</i></sub>}</span> and <span class="tex-span">{<i>c</i><sub class="lower-index">1</sub>,&#x2009;<i>c</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>c</i><sub class="lower-index"><i>m</i></sub>}</span>, <span class="tex-span"><i>m</i>&#x2009;+&#x2009;<i>k</i>&#x2009;=&#x2009;<i>n</i></span>, so that the value of <span class="tex-span"><i>S</i>&#x2009;=&#x2009;|<i>f</i>(<i>b</i><sub class="lower-index">1</sub>,&#x2009;<i>b</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>b</i><sub class="lower-index"><i>k</i></sub>)|&#x2009;+&#x2009;|<i>f</i>(<i>c</i><sub class="lower-index">1</sub>,&#x2009;<i>c</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>c</i><sub class="lower-index"><i>m</i></sub>)|</span> took the minimum possible value. Here <span class="tex-span">|<i>p</i>|</span> denotes the length of the string <span class="tex-span"><i>p</i></span>.</p><p>Note that it is not allowed to change the relative order of lines in the subsequences. It is allowed to make one of the subsequences empty. Each string from the initial sequence should belong to exactly one subsequence. Elements of subsequences <span class="tex-span"><i>b</i></span> and <span class="tex-span"><i>c</i></span> don&apos;t have to be consecutive in the original sequence <span class="tex-span"><i>a</i></span>, i. e. elements of <span class="tex-span"><i>b</i></span> and <span class="tex-span"><i>c</i></span> can alternate in <span class="tex-span"><i>a</i></span> (see samples 2 and 3).</p><p>Help Valera to find the minimum possible value of <span class="tex-span"><i>S</i></span>.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input data contains an integer <span class="tex-span"><i>n</i></span> &#x2014; the number of strings (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;2&#xB7;10<sup class="upper-index">5</sup></span>). Then on <span class="tex-span"><i>n</i></span> lines follow elements of the sequence &#x2014; strings whose lengths are from <span class="tex-span">1</span> to <span class="tex-span">20</span> characters, consisting only of digits <span class="tex-span">0</span> and <span class="tex-span">1</span>. The <span class="tex-span"><i>i</i>&#x2009;+&#x2009;1</span>-th input line contains the <span class="tex-span"><i>i</i></span>-th element of the sequence. Elements of the sequence are separated only by a newline. It is guaranteed that all lines have the same length.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number &#x2014; the minimum possible value of <span class="tex-span"><i>S</i></span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3<br>01<br>10<br>01<br></pre></div><div class="output"><div class="title">Output</div><pre>4<br></pre></div><div class="input"><div class="title">Input</div><pre>4<br>000<br>111<br>110<br>001<br></pre></div><div class="output"><div class="title">Output</div><pre>8<br></pre></div><div class="input"><div class="title">Input</div><pre>5<br>10101<br>01010<br>11111<br>01000<br>10010<br></pre></div><div class="output"><div class="title">Output</div><pre>17<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Detailed answers to the tests:</p><ul> <li> The best option is to make one of the subsequences empty, and the second one equal to the whole given sequence. <span class="tex-span">|<i>f</i>(01,&#x2009;10,&#x2009;01)|&#x2009;=&#x2009;|<i>f</i>(<i>f</i>(01,&#x2009;10),&#x2009;01)|&#x2009;=&#x2009;|<i>f</i>(010,&#x2009;01)|&#x2009;=&#x2009;|0101|&#x2009;=&#x2009;4</span>. </li><li> The best option is: <span class="tex-span"><i>b</i>&#x2009;=&#x2009;{000,&#x2009;001},&#x2009;<i>c</i>&#x2009;=&#x2009;{111,&#x2009;110}.</span> <span class="tex-span"><i>S</i>&#x2009;=&#x2009;|<i>f</i>(000,&#x2009;001)|&#x2009;+&#x2009;|<i>f</i>(111,&#x2009;110)|&#x2009;=&#x2009;|0001|&#x2009;+&#x2009;|1110|&#x2009;=&#x2009;8</span>. </li><li> The best option is: <span class="tex-span"><i>b</i>&#x2009;=&#x2009;{10101,&#x2009;01010,&#x2009;01000},&#x2009;<i>c</i>&#x2009;=&#x2009;{11111,&#x2009;10010}.</span> <span class="tex-span"><i>S</i>&#x2009;=&#x2009;|10101000|&#x2009;+&#x2009;|111110010|&#x2009;=&#x2009;17</span>. </li></ul></div></div></div>
</div>