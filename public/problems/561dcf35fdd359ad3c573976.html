<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Dima and Magic Guitar</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Dima loves Inna very much. He decided to write a song for her. Dima has a magic guitar with <span class="tex-span"><i>n</i></span> strings and <span class="tex-span"><i>m</i></span> frets. Dima makes the guitar produce sounds like that: to play a note, he needs to hold one of the strings on one of the frets and then pull the string. When Dima pulls the <span class="tex-span"><i>i</i></span>-th string holding it on the <span class="tex-span"><i>j</i></span>-th fret the guitar produces a note, let&apos;s denote it as <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub></span>. We know that Dima&apos;s guitar can produce <span class="tex-span"><i>k</i></span> distinct notes. It is possible that some notes can be produced in multiple ways. In other words, it is possible that <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub>&#x2009;=&#x2009;<i>a</i><sub class="lower-index"><i>pq</i></sub></span> at <span class="tex-span">(<i>i</i>,&#x2009;<i>j</i>)&#x2009;&#x2260;&#x2009;(<i>p</i>,&#x2009;<i>q</i>)</span>.</p><p>Dima has already written a song &#x2014; a sequence of <span class="tex-span"><i>s</i></span> notes. In order to play the song, you need to consecutively produce the notes from the song on the guitar. You can produce each note in any available way. Dima understood that there are many ways to play a song and he wants to play it so as to make the song look as complicated as possible (try to act like Cobein).</p><p>We&apos;ll represent a way to play a song as a sequence of pairs <span class="tex-span">(<i>x</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>y</i><sub class="lower-index"><i>i</i></sub>)</span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>i</i>&#x2009;&#x2264;&#x2009;<i>s</i>)</span>, such that the <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span>-th string on the <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span>-th fret produces the <span class="tex-span"><i>i</i></span>-th note from the song. The complexity of moving between pairs <span class="tex-span">(<i>x</i><sub class="lower-index">1</sub>,&#x2009;<i>y</i><sub class="lower-index">1</sub>)</span> and <span class="tex-span">(<i>x</i><sub class="lower-index">2</sub>,&#x2009;<i>y</i><sub class="lower-index">2</sub>)</span> equals <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/9f/7e/9f7efc80536590709ad22484dcf9132487b354e8.png"> + <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/09/53/0953d13597032746b3b13e0a7a4b2611cabfa2f1.png">. The complexity of a way to play a song is the maximum of complexities of moving between adjacent pairs.</p><p>Help Dima determine the maximum complexity of the way to play his song! The guy&apos;s gotta look cool!</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input contains four integers <span class="tex-span"><i>n</i></span>, <span class="tex-span"><i>m</i></span>, <span class="tex-span"><i>k</i></span> and <span class="tex-span"><i>s</i></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>n</i>,&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;2000,&#x2009;1&#x2009;&#x2264;&#x2009;<i>k</i>&#x2009;&#x2264;&#x2009;9,&#x2009;2&#x2009;&#x2264;&#x2009;<i>s</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup>)</span>. </p><p>Then follow <span class="tex-span"><i>n</i></span> lines, each containing <span class="tex-span"><i>m</i></span> integers <span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>a</i><sub class="lower-index"><i>ij</i></sub>&#x2009;&#x2264;&#x2009;<i>k</i>)</span>. The number in the <span class="tex-span"><i>i</i></span>-th row and the <span class="tex-span"><i>j</i></span>-th column (<span class="tex-span"><i>a</i><sub class="lower-index"><i>ij</i></sub></span>) means a note that the guitar produces on the <span class="tex-span"><i>i</i></span>-th string and the <span class="tex-span"><i>j</i></span>-th fret.</p><p>The last line of the input contains <span class="tex-span"><i>s</i></span> integers <span class="tex-span"><i>q</i><sub class="lower-index"><i>i</i></sub></span> <span class="tex-span">(1&#x2009;&#x2264;&#x2009;<i>q</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>k</i>)</span> &#x2014; the sequence of notes of the song.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In a single line print a single number &#x2014; the maximum possible complexity of the song.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4 6 5 7<br>3 1 2 2 3 1<br>3 2 2 2 5 5<br>4 2 2 2 5 3<br>3 2 2 1 4 3<br>2 3 1 4 1 5 1<br></pre></div><div class="output"><div class="title">Output</div><pre>8<br></pre></div><div class="input"><div class="title">Input</div><pre>4 4 9 5<br>4 7 9 5<br>1 2 1 7<br>8 3 4 9<br>5 7 7 2<br>7 1 9 2 5<br></pre></div><div class="output"><div class="title">Output</div><pre>4<br></pre></div></div></div></div></div>
</div>