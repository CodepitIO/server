<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Palisection</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>128 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>In an English class Nick had nothing to do at all, and remembered about wonderful strings called <span class="tex-font-style-it">palindromes</span>. We should remind you that a string is called a palindrome if it can be read the same way both from left to right and from right to left. Here are examples of such strings: &#xAB;<span class="tex-font-style-tt">eye</span>&#xBB;, &#xAB;<span class="tex-font-style-tt">pop</span>&#xBB;, &#xAB;<span class="tex-font-style-tt">level</span>&#xBB;, &#xAB;<span class="tex-font-style-tt">aba</span>&#xBB;, &#xAB;<span class="tex-font-style-tt">deed</span>&#xBB;, &#xAB;<span class="tex-font-style-tt">racecar</span>&#xBB;, &#xAB;<span class="tex-font-style-tt">rotor</span>&#xBB;, &#xAB;<span class="tex-font-style-tt">madam</span>&#xBB;. </p><p>Nick started to look carefully for all palindromes in the text that they were reading in the class. For each occurrence of each palindrome in the text he wrote a pair &#x2014; the position of the beginning and the position of the ending of this occurrence in the text. Nick called each occurrence of each palindrome he found in the text <span class="tex-font-style-it">subpalindrome</span>. When he found all the subpalindromes, he decided to find out how many different pairs among these subpalindromes cross. Two subpalindromes cross if they cover common positions in the text. No palindrome can cross itself.</p><p>Let&apos;s look at the actions, performed by Nick, by the example of text &#xAB;<span class="tex-font-style-tt">babb</span>&#xBB;. At first he wrote out all subpalindromes:</p><center>&#x2022; &#xAB;<span class="tex-font-style-tt">b</span>&#xBB; &#x2014; <span class="tex-span">1..1</span> </center><center>&#x2022; &#xAB;<span class="tex-font-style-tt">bab</span>&#xBB; &#x2014; <span class="tex-span">1..3</span> </center><center>&#x2022; &#xAB;<span class="tex-font-style-tt">a</span>&#xBB; &#x2014; <span class="tex-span">2..2</span> </center><center>&#x2022; &#xAB;<span class="tex-font-style-tt">b</span>&#xBB; &#x2014; <span class="tex-span">3..3</span> </center><center>&#x2022; &#xAB;<span class="tex-font-style-tt">bb</span>&#xBB; &#x2014; <span class="tex-span">3..4</span> </center><center>&#x2022; &#xAB;<span class="tex-font-style-tt">b</span>&#xBB; &#x2014; <span class="tex-span">4..4</span> </center><p>Then Nick counted the amount of different pairs among these subpalindromes that cross. These pairs were six:</p><center> <span class="tex-font-style-tt">1.</span> <span class="tex-span">1..1</span> cross with <span class="tex-span">1..3</span> </center><center> <span class="tex-font-style-tt">2.</span> <span class="tex-span">1..3</span> cross with <span class="tex-span">2..2</span> </center><center> <span class="tex-font-style-tt">3.</span> <span class="tex-span">1..3</span> cross with <span class="tex-span">3..3</span> </center><center> <span class="tex-font-style-tt">4.</span> <span class="tex-span">1..3</span> cross with <span class="tex-span">3..4</span> </center><center> <span class="tex-font-style-tt">5.</span> <span class="tex-span">3..3</span> cross with <span class="tex-span">3..4</span> </center><center> <span class="tex-font-style-tt">6.</span> <span class="tex-span">3..4</span> cross with <span class="tex-span">4..4</span> </center><p>Since it&apos;s very exhausting to perform all the described actions manually, Nick asked you to help him and write a program that can find out the amount of different subpalindrome pairs that cross. Two subpalindrome pairs are regarded as different if one of the pairs contains a subpalindrome that the other does not.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first input line contains integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;2&#xB7;10<sup class="upper-index">6</sup></span>) &#x2014; length of the text. The following line contains <span class="tex-span"><i>n</i></span> lower-case Latin letters (from <span class="tex-font-style-tt">a</span> to <span class="tex-font-style-tt">z</span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the only line output the amount of different pairs of two subpalindromes that cross each other. Output the answer modulo <span class="tex-span">51123987</span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>4<br>babb<br></pre></div><div class="output"><div class="title">Output</div><pre>6<br></pre></div><div class="input"><div class="title">Input</div><pre>2<br>aa<br></pre></div><div class="output"><div class="title">Output</div><pre>2<br></pre></div></div></div></div></div>
</div>