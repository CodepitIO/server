<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Interesting Graph and Apples</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>64 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Hexadecimal likes drawing. She has drawn many graphs already, both directed and not. Recently she has started to work on a still-life &#xAB;interesting graph and apples&#xBB;. An undirected graph is called interesting, if each of its vertices belongs to one cycle only &#x2014; a funny ring &#x2014; and does not belong to any other cycles. A funny ring is a cycle that goes through all the vertices just once. Moreover, loops are funny rings too.</p><p>She has already drawn the apples and some of the graph edges. But now it is not clear, how to connect the rest of the vertices to get an interesting graph as a result. The answer should contain the minimal amount of added edges. And furthermore, the answer should be the lexicographically smallest one. The set of edges <span class="tex-span">(<i>x</i><sub class="lower-index">1</sub>,&#x2009;<i>y</i><sub class="lower-index">1</sub>),&#x2009;(<i>x</i><sub class="lower-index">2</sub>,&#x2009;<i>y</i><sub class="lower-index">2</sub>),&#x2009;...,&#x2009;(<i>x</i><sub class="lower-index"><i>n</i></sub>,&#x2009;<i>y</i><sub class="lower-index"><i>n</i></sub>)</span>, where <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>y</i><sub class="lower-index"><i>i</i></sub></span>, is lexicographically smaller than the set <span class="tex-span">(<i>u</i><sub class="lower-index">1</sub>,&#x2009;<i>v</i><sub class="lower-index">1</sub>),&#x2009;(<i>u</i><sub class="lower-index">2</sub>,&#x2009;<i>v</i><sub class="lower-index">2</sub>),&#x2009;...,&#x2009;(<i>u</i><sub class="lower-index"><i>n</i></sub>,&#x2009;<i>v</i><sub class="lower-index"><i>n</i></sub>)</span>, where <span class="tex-span"><i>u</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>v</i><sub class="lower-index"><i>i</i></sub></span>, provided that the sequence of integers <span class="tex-span"><i>x</i><sub class="lower-index">1</sub>,&#x2009;<i>y</i><sub class="lower-index">1</sub>,&#x2009;<i>x</i><sub class="lower-index">2</sub>,&#x2009;<i>y</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>x</i><sub class="lower-index"><i>n</i></sub>,&#x2009;<i>y</i><sub class="lower-index"><i>n</i></sub></span> is lexicographically smaller than the sequence <span class="tex-span"><i>u</i><sub class="lower-index">1</sub>,&#x2009;<i>v</i><sub class="lower-index">1</sub>,&#x2009;<i>u</i><sub class="lower-index">2</sub>,&#x2009;<i>v</i><sub class="lower-index">2</sub>,&#x2009;...,&#x2009;<i>u</i><sub class="lower-index"><i>n</i></sub>,&#x2009;<i>v</i><sub class="lower-index"><i>n</i></sub></span>. If you do not cope, Hexadecimal will eat you. ...eat you alive.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of the input data contains a pair of integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;50</span>, <span class="tex-span">0&#x2009;&#x2264;&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;2500</span>) &#x2014; the amount of vertices and edges respectively. The following lines contain pairs of numbers <span class="tex-span"><i>x</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>x</i><sub class="lower-index"><i>i</i></sub></span>, <span class="tex-span"><i>y</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>n</i></span>) &#x2014; the vertices that are already connected by edges. The initial graph may contain multiple edges and loops.</p></div><div class="output-specification"><div class="section-title">Output</div><p>In the first line output &#xAB;<span class="tex-font-style-tt">YES</span>&#xBB; or &#xAB;<span class="tex-font-style-tt">NO</span>&#xBB;: if it is possible or not to construct an interesting graph. If the answer is &#xAB;<span class="tex-font-style-tt">YES</span>&#xBB;, in the second line output <span class="tex-span"><i>k</i></span> &#x2014; the amount of edges that should be added to the initial graph. Finally, output <span class="tex-span"><i>k</i></span> lines: pairs of vertices <span class="tex-span"><i>x</i><sub class="lower-index"><i>j</i></sub></span> and <span class="tex-span"><i>y</i><sub class="lower-index"><i>j</i></sub></span>, between which edges should be drawn. The result may contain multiple edges and loops. <span class="tex-span"><i>k</i></span> can be equal to zero.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 2<br>1 2<br>2 3<br></pre></div><div class="output"><div class="title">Output</div><pre>YES<br>1<br>1 3<br></pre></div></div></div></div></div>
</div>