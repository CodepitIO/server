<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Cycle</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Little Petya very much likes rectangular tables that consist of characters &quot;0&quot; and &quot;1&quot;. Recently he has received one such table as a gift from his mother. The table contained <span class="tex-span"><i>n</i></span> rows and <span class="tex-span"><i>m</i></span> columns. The rows are numbered from top to bottom from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>, the columns are numbered from the left to the right from <span class="tex-span">1</span> to <span class="tex-span"><i>m</i></span>. Petya immediately decided to find the longest cool cycle whatever it takes.</p><p>A cycle is a sequence of pairwise distinct cells where each two consecutive cells have a common side; besides, the first cell has a common side with the last cell. A cycle is called cool if it fulfills all the following conditions simultaneously: </p><ul> <li> The cycle entirely consists of the cells that contain &quot;1&quot;. </li><li> Each cell that belongs to the cycle, has a common side with exactly two other cells that belong to the cycle. </li><li> Each cell of the table that contains &quot;1&quot; either belongs to the cycle or is positioned outside of it (see definition below). </li></ul><p>To define the notion of &quot;outside&quot; formally, let&apos;s draw a cycle on a plane. Let each cell of the cycle <span class="tex-span">(<i>i</i>,&#x2009;<i>j</i>)</span> (<span class="tex-span"><i>i</i></span> is the row number, <span class="tex-span"><i>j</i></span> is the column number) correspond to the point <span class="tex-span">(<i>i</i>,&#x2009;<i>j</i>)</span> on the coordinate plane. Let a straight line segment join each pair of points that correspond to the cells belonging to the cycle and sharing a side. Thus, we will get a closed polyline that has no self-intersections and self-touches. The polyline divides the plane into two connected parts: the part of an infinite area and the part of a finite area. It is considered that cell <span class="tex-span">(<i>r</i>,&#x2009;<i>c</i>)</span> lies outside of the cycle if it does not belong to the cycle and the corresponding point on the plane with coordinates <span class="tex-span">(<i>r</i>,&#x2009;<i>c</i>)</span> lies in the part with the infinite area.</p><p>Help Petya to find the length of the longest cool cycle in the table. The cycle length is defined as the number of cells that belong to the cycle.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>n</i>,&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;1000</span>) &#x2014; the number of rows and columns in the table, respectively. Each of the following <span class="tex-span"><i>n</i></span> lines contains <span class="tex-span"><i>m</i></span> characters. Each character can be either &quot;0&quot; or &quot;1&quot;.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number &#x2014; the length of the longest cool cycle in the table. If such cycles do not exist, print 0.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 3<br>111<br>101<br>111<br></pre></div><div class="output"><div class="title">Output</div><pre>8<br></pre></div><div class="input"><div class="title">Input</div><pre>5 5<br>01010<br>10101<br>01010<br>10101<br>01010<br></pre></div><div class="output"><div class="title">Output</div><pre>0<br></pre></div><div class="input"><div class="title">Input</div><pre>7 7<br>1111111<br>1000101<br>1000101<br>1000101<br>1000111<br>1000001<br>1111111<br></pre></div><div class="output"><div class="title">Output</div><pre>24<br></pre></div><div class="input"><div class="title">Input</div><pre>5 5<br>11111<br>10001<br>10101<br>10001<br>11111<br></pre></div><div class="output"><div class="title">Output</div><pre>0<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the first example there&apos;s only one cycle and it is cool.</p><p>In the second sample there&apos;s no cycle at all.</p><p>In the third sample there are two cool cycles: their lengths are 12 and 24.</p><p>In the fourth sample there also is only one cycle but it isn&apos;t cool as there&apos;s a cell containing &quot;1&quot; inside this cycle.</p></div></div></div>
</div>