<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="D">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Domino Carpet</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p><span class="tex-font-style-it">...Mike the TV greets you again!</span> </p><p><span class="tex-font-style-it">Tired of the monotonous furniture? Sick of gray routine? Dreaming about dizzying changes in your humble abode? We have something to offer you!</span> </p><p><span class="tex-font-style-it">This domino carpet for only $99.99 will change your life! You can lay it on the floor, hang it on the wall or even on the ceiling! Among other things ...</span> </p><p>Having watched the commercial, virus Hexadecimal also wanted to get a Domino Carpet and wanted badly to be photographed in front of it. But of course, a virus will never consent to buying a licensed Carpet! So she ordered a truck of dominoes and decided to make such a Carpet herself. </p><p>The original Domino Carpet is a field of squares <span class="tex-span"><i>n</i>&#x2009;&#xD7;&#x2009;<i>m</i></span> in size. Each square is half of a domino, and can be rotated either vertically or horizontally, independently from its neighbors. Vertically rotated domino halves look like this: </p><center> <img class="tex-graphics" src="http://codeforces.com/predownloaded/17/53/1753514f4ae82c20acb5b32719bf302749f9f45d.png"> </center> <p>And horizontally rotated halves look like this: </p><center> <img class="tex-graphics" src="http://codeforces.com/predownloaded/97/51/9751d7b20613cc84812cb5470c5250352bfe4805.png"> </center><p>Notice, that some halves looks the same in both rotations, but other halves differ.</p><p>Dominoes bought by Hexadecimal are represented by uncuttable chips <span class="tex-span">1&#x2009;&#xD7;&#x2009;2</span> in size, which can be laid either vertically or horizontally. If the chip is laid vertically, then both of it&apos;s halves should be laid vertically orientated; if the chip is laid horizontally, then both of it&apos;s halves should be laid horizontally.</p><p>The samples of valid and invalid dominoes laid vertically and horizontally are: </p><center> <img class="tex-graphics" src="http://codeforces.com/predownloaded/1d/a3/1da3505eba3e28c0396f15e54f2553b6300812f7.png"> </center> <p>Virus Hexadecimal assembles her own Domino Carpet so that the following conditions are satisfied:</p><ul> <li> each carpet square is covered by a domino chip, i.e. there are no empty squares; </li><li> all domino chips lie entirely within the carpet and don&apos;t overlap with each other; </li><li> if there is a horizontal domino chip with its left half in column <span class="tex-span"><i>j</i></span> then there are no horizontal domino chips with their left halves in columns <span class="tex-span"><i>j</i>&#x2009;-&#x2009;1</span> or <span class="tex-span"><i>j</i>&#x2009;+&#x2009;1</span>. </li></ul><p>Before starting to assemble her own Domino Carpet, the virus wants to know the number of ways to achieve the intended purpose modulo <span class="tex-span">10<sup class="upper-index">9</sup>&#x2009;+&#x2009;7</span>.</p><p>You can assume that the virus has an infinitely large number of dominoes of each type.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains two integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>m</i></span>, separated by a space &#x2014; the size of the Domino Carpet (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>n</i>,&#x2009;<i>m</i>&#x2009;&#x2264;&#x2009;250</span>). Next <span class="tex-span">4<i>n</i>&#x2009;+&#x2009;1</span> lines contain <span class="tex-span">4<i>m</i>&#x2009;+&#x2009;1</span> symbols. </p><p>Each square of the Domino Carpet, which is a domino half, is described by a <span class="tex-span">3&#x2009;&#xD7;&#x2009;3</span> square. Symbol <span class="tex-font-style-tt">&apos;O&apos;</span> in this square indicates the presence of a point, symbol <span class="tex-font-style-tt">&apos;.&apos;</span> &#x2014; its absence. </p><p>Each <span class="tex-span">3&#x2009;&#xD7;&#x2009;3</span> square is delineated from adjacent squares by symbols <span class="tex-font-style-tt">&apos;#&apos;</span> as shown in the examples. </p><p>It is guaranteed that every box describes the correct half of a domino. </p><p>In all pretests the Domino Carpets have the size of <span class="tex-span">2&#x2009;&#xD7;&#x2009;2</span> and <span class="tex-span">4&#x2009;&#xD7;&#x2009;4</span>.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print a single number, the number of ways to assemble the Domino Carpet modulo <span class="tex-span">10<sup class="upper-index">9</sup>&#x2009;+&#x2009;7</span>, using only standard dominoes of size <span class="tex-span">1&#x2009;&#xD7;&#x2009;2</span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>3 4<br>#################<br>#O..#...#O.O#...#<br>#.O.#.O.#.O.#...#<br>#..O#...#O.O#...#<br>#################<br>#O.O#OOO#O.O#...#<br>#.O.#...#...#.O.#<br>#O.O#OOO#O.O#...#<br>#################<br>#O.O#...#O.O#...#<br>#...#...#...#.O.#<br>#O.O#...#O.O#...#<br>#################<br></pre></div><div class="output"><div class="title">Output</div><pre>3</pre></div><div class="input"><div class="title">Input</div><pre>2 2<br>#########<br>#O.O#O.O#<br>#.O.#...#<br>#O.O#O.O#<br>#########<br>#...#O.O#<br>#...#...#<br>#...#O.O#<br>#########<br></pre></div><div class="output"><div class="title">Output</div><pre>2</pre></div><div class="input"><div class="title">Input</div><pre>2 2<br>#########<br>#..O#O..#<br>#...#...#<br>#O..#..O#<br>#########<br>#O..#..O#<br>#...#...#<br>#..O#O..#<br>#########<br></pre></div><div class="output"><div class="title">Output</div><pre>0</pre></div></div></div><div class="note"><div class="section-title">Note</div><p><span class="tex-font-style-bf">A note to the first example:</span> all correct ways to make Domino Carpet are represented below:</p><center> <img class="tex-graphics" src="http://codeforces.com/predownloaded/a0/ae/a0ae8f1f728b8f2be8790f3a76820462f116ec54.png"> </center><p>And this way is incorrect:</p><center> <img class="tex-graphics" src="http://codeforces.com/predownloaded/61/3c/613cee7de4784bfcd0d9990fe6f880ff2790aee5.png"> </center></div></div></div>
</div>