<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="B">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Bribes</div><div class="time-limit"><div class="property-title">time limit per test</div>1 second</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Ruritania is a country with a very badly maintained road network, which is not exactly good news for lorry drivers that constantly have to do deliveries. In fact, when roads are maintained, they become <span class="tex-font-style-bf">one-way</span>. It turns out that it is sometimes impossible to get from one town to another in a legal way &#x2013; however, we know that all towns are <span class="tex-font-style-bf">reachable</span>, though <span class="tex-font-style-bf">illegally</span>!</p><p>Fortunately for us, the police tend to be very corrupt and they will allow a lorry driver to break the rules and drive in the wrong direction provided they receive &#x2018;a small gift&#x2019;. There is one patrol car for every road and they will request 1000 Ruritanian dinars when a driver drives in the wrong direction. However, being greedy, every time a patrol car notices the same driver breaking the rule, they will charge <span class="tex-font-style-bf">double</span> the amount of money they requested the previous time on that particular road.</p><p>Borna is a lorry driver that managed to figure out this bribing pattern. As part of his job, he has to make <span class="tex-span"><i>K</i></span> stops in some towns all over Ruritania and he has to make these stops in a certain order. There are <span class="tex-span"><i>N</i></span> towns (enumerated from 1 to <span class="tex-span"><i>N</i></span>) in Ruritania and Borna&#x2019;s initial location is the capital city i.e. town 1. He happens to know which ones out of the <span class="tex-span"><i>N</i>&#x2009;-&#x2009;1</span> roads in Ruritania are currently unidirectional, but he is unable to compute the least amount of money he needs to prepare for bribing the police. Help Borna by providing him with an answer and you will be richly rewarded.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line contains <span class="tex-span"><i>N</i></span>, the number of towns in Ruritania. The following <span class="tex-span"><i>N</i>&#x2009;-&#x2009;1</span> lines contain information regarding individual roads between towns. A road is represented by a tuple of integers (<span class="tex-span"><i>a</i></span>,<span class="tex-span"><i>b</i></span>,<span class="tex-span"><i>x</i></span>), which are separated with a single whitespace character. The numbers <span class="tex-span"><i>a</i></span> and <span class="tex-span"><i>b</i></span> represent the cities connected by this particular road, and x is either 0 or 1: 0 means that the road is bidirectional, 1 means that only the <span class="tex-span"><i>a</i>&#x2009;&#x2192;&#x2009;<i>b</i></span> direction is legal. The next line contains <span class="tex-span"><i>K</i></span>, the number of stops Borna has to make. The final line of input contains K positive integers <span class="tex-span"><i>s</i><sub class="lower-index">1</sub>,&#x2009;&#x2026;,&#x2009;<i>s</i><sub class="lower-index"><i>K</i></sub></span>: the towns Borna has to visit.</p><ul> <li> <span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>N</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">5</sup></span> </li><li> <span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>K</i>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">6</sup></span> </li><li> <span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>a</i>,&#x2009;<i>b</i>&#x2009;&#x2264;&#x2009;<i>N</i></span> for all roads </li><li> <img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/70/70/7070a730beed24d346a45a76094d65a3276c5490.png"> for all roads </li><li> <span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>s</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>N</i></span> for all <span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>i</i>&#x2009;&#x2264;&#x2009;<i>K</i></span> </li></ul></div><div class="output-specification"><div class="section-title">Output</div><p>The output should contain a single number: the least amount of thousands of Ruritanian dinars Borna should allocate for bribes, modulo <span class="tex-span">10<sup class="upper-index">9</sup>&#x2009;+&#x2009;7</span>.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5<br>1 2 0<br>2 3 0<br>5 1 1<br>3 4 1<br>5<br>5 4 5 2 2<br></pre></div><div class="output"><div class="title">Output</div><pre>4<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>Borna first takes the route <span class="tex-span">1&#x2009;&#x2192;&#x2009;5</span> and has to pay 1000 dinars. After that, he takes the route <span class="tex-span">5&#x2009;&#x2192;&#x2009;1&#x2009;&#x2192;&#x2009;2&#x2009;&#x2192;&#x2009;3&#x2009;&#x2192;&#x2009;4</span> and pays nothing this time. However, when he has to return via <span class="tex-span">4&#x2009;&#x2192;&#x2009;3&#x2009;&#x2192;&#x2009;2&#x2009;&#x2192;&#x2009;1&#x2009;&#x2192;&#x2009;5</span>, he needs to prepare 3000 (1000+2000) dinars. Afterwards, getting to 2 via <span class="tex-span">5&#x2009;&#x2192;&#x2009;1&#x2009;&#x2192;&#x2009;2</span> will cost him nothing. Finally, he doesn&apos;t even have to leave town 2 to get to 2, so there is no need to prepare any additional bribe money. Hence he has to prepare 4000 dinars in total.</p></div></div></div>
</div>