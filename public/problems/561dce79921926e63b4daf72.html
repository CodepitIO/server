<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Mike and Friends</div><div class="time-limit"><div class="property-title">time limit per test</div>3 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>What-The-Fatherland is a strange country! All phone numbers there are strings consisting of lowercase English letters. What is double strange that a phone number can be associated with several bears!</p><p>In that country there is a rock band called CF consisting of <span class="tex-span"><i>n</i></span> bears (including Mike) numbered from <span class="tex-span">1</span> to <span class="tex-span"><i>n</i></span>. </p><center> <img class="tex-graphics" src="http://codeforces.com/predownloaded/ff/be/ffbeb480bcd05d35f9862b9801d9e06f381f7e76.png"> </center><p>Phone number of <span class="tex-span"><i>i</i></span>-th member of CF is <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span>. May 17th is a holiday named Phone Calls day. In the last Phone Calls day, everyone called all the numbers that are substrings of his/her number (one may call some number several times). In particular, everyone called himself (that was really strange country).</p><p>Denote as <span class="tex-span"><i>call</i>(<i>i</i>,&#x2009;<i>j</i>)</span> the number of times that <span class="tex-span"><i>i</i></span>-th member of CF called the <span class="tex-span"><i>j</i></span>-th member of CF. </p><p>The geek Mike has <span class="tex-span"><i>q</i></span> questions that he wants to ask you. In each question he gives you numbers <span class="tex-span"><i>l</i>,&#x2009;<i>r</i></span> and <span class="tex-span"><i>k</i></span> and you should tell him the number </p><center class="tex-equation"><img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/55/f3/55f324bcb8d36ec0172345f4d5d8f92325eede28.png"></center></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains integers <span class="tex-span"><i>n</i></span> and <span class="tex-span"><i>q</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;2&#x2009;&#xD7;&#x2009;10<sup class="upper-index">5</sup></span> and <span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>q</i>&#x2009;&#x2264;&#x2009;5&#x2009;&#xD7;&#x2009;10<sup class="upper-index">5</sup></span>).</p><p>The next <span class="tex-span"><i>n</i></span> lines contain the phone numbers, <span class="tex-span"><i>i</i></span>-th line contains a string <span class="tex-span"><i>s</i><sub class="lower-index"><i>i</i></sub></span> consisting of lowercase English letters (<img align="middle" class="tex-formula" src="http://codeforces.com/predownloaded/b1/50/b150a790d6ff8d32ecde0315bc6cb43df6e1577a.png">).</p><p>The next <span class="tex-span"><i>q</i></span> lines contain the information about the questions, each of them contains integers <span class="tex-span"><i>l</i>,&#x2009;<i>r</i></span> and <span class="tex-span"><i>k</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>l</i>&#x2009;&#x2264;&#x2009;<i>r</i>&#x2009;&#x2264;&#x2009;<i>n</i></span> and <span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>k</i>&#x2009;&#x2264;&#x2009;<i>n</i></span>).</p></div><div class="output-specification"><div class="section-title">Output</div><p>Print the answer for each question in a separate line.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>5 5<br>a<br>ab<br>abab<br>ababab<br>b<br>1 5 1<br>3 5 1<br>1 5 2<br>1 5 3<br>1 4 5<br></pre></div><div class="output"><div class="title">Output</div><pre>7<br>5<br>6<br>3<br>6<br></pre></div></div></div></div></div>
</div>