<link rel="stylesheet" href="http://st.codeforces.com/css/ttypography.css" type="text/css" charset="utf-8"><link rel="stylesheet" href="http://st.codeforces.com/css/problem-statement.css" type="text/css" charset="utf-8"><div class="problemindexholder" problemindex="E">
<div class="ttypography"><div class="problem-statement"><div class="header"><div class="title">Alien DNA</div><div class="time-limit"><div class="property-title">time limit per test</div>2 seconds</div><div class="memory-limit"><div class="property-title">memory limit per test</div>256 megabytes</div><div class="input-file"><div class="property-title">input</div>standard input</div><div class="output-file"><div class="property-title">output</div>standard output</div></div><div><p>Professor Bajtocy is conducting experiments on alien DNA. He has discovered that it is subject to repetitive mutations &#x2014; each mutation happens in the same way: some continuous subsequence of the alien DNA becomes active, copies itself, the copy gets mangled and inserts itself right after the original subsequence. The mangled copy of the activated continuous subsequence is formed by first joining all the elements at the even positions in that subsequence, and then joining all the elements at the odd ones at the end. That is, if the activated subsequence consists of 11 elements and represented as <span class="tex-span"><i>s</i><sub class="lower-index">1</sub><i>s</i><sub class="lower-index">2</sub>... <i>s</i><sub class="lower-index">11</sub></span>, its mangled copy is <span class="tex-span"><i>s</i><sub class="lower-index">2</sub><i>s</i><sub class="lower-index">4</sub><i>s</i><sub class="lower-index">6</sub><i>s</i><sub class="lower-index">8</sub><i>s</i><sub class="lower-index">10</sub><i>s</i><sub class="lower-index">1</sub><i>s</i><sub class="lower-index">3</sub><i>s</i><sub class="lower-index">5</sub><i>s</i><sub class="lower-index">7</sub><i>s</i><sub class="lower-index">9</sub><i>s</i><sub class="lower-index">11</sub></span>.</p><p>For example, if the original sequence was &quot;<span class="tex-font-style-tt">ACTGG</span>&quot; and the mutation happened on the segment <span class="tex-span">[2,&#x2009;4]</span> (that is the activated subsequence is &quot;<span class="tex-font-style-tt">CTG</span>&quot;), the mutated DNA is: &quot;<span class="tex-font-style-tt">ACTG<span class="tex-font-style-bf">TCG</span>G</span>&quot;. The mangled copy of the activated subsequence is marked with bold font.</p><p>Professor Bajtocy has written down the original DNA sequence and the mutations that sequentially happened to it, and he now asks you to recover the first <span class="tex-span"><i>k</i></span> elements of the DNA sequence after all the mutations.</p></div><div class="input-specification"><div class="section-title">Input</div><p>The first line of input contains the original DNA sequence, consisting only of letters &quot;<span class="tex-font-style-tt">A</span>&quot;, &quot;<span class="tex-font-style-tt">C</span>&quot;, &quot;<span class="tex-font-style-tt">T</span>&quot; and &quot;<span class="tex-font-style-tt">G</span>&quot; and not exceeding <span class="tex-span">3&#xB7;10<sup class="upper-index">6</sup></span> in length. </p><p>The second line contains a single integer <span class="tex-span"><i>k</i></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>k</i>&#x2009;&#x2264;&#x2009;3&#xB7;10<sup class="upper-index">6</sup></span>).</p><p>The third line contains a single integer <span class="tex-span"><i>n</i></span> (<span class="tex-span">0&#x2009;&#x2264;&#x2009;<i>n</i>&#x2009;&#x2264;&#x2009;5000</span>) &#x2014; the number of mutations. The next <span class="tex-span"><i>n</i></span> lines describe the mutations in chronological order &#x2014; each mutation is described by two numbers <span class="tex-span"><i>l</i><sub class="lower-index"><i>i</i></sub></span> and <span class="tex-span"><i>r</i><sub class="lower-index"><i>i</i></sub></span> (<span class="tex-span">1&#x2009;&#x2264;&#x2009;<i>l</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;<i>r</i><sub class="lower-index"><i>i</i></sub>&#x2009;&#x2264;&#x2009;10<sup class="upper-index">9</sup></span>), meaning that the continuous subsequence <span class="tex-span">[<i>l</i><sub class="lower-index"><i>i</i></sub>,&#x2009;<i>r</i><sub class="lower-index"><i>i</i></sub>]</span> has become active and cloned itself, joining itself with the mangled copy. </p><p>It is guaranteed that the input data is correct, that is, no mutation acts on non-existing elements of the DNA sequence, and the resulting DNA sequence has at least <span class="tex-span"><i>k</i></span> elements.</p><p>Assume that the DNA elements are indexed starting from 1 and that the notation <span class="tex-span">[<i>l</i>,&#x2009;<i>r</i>]</span> meaning the continuous subsequence of DNA sequence that consists of <span class="tex-span"><i>r</i>&#x2009;-&#x2009;<i>l</i>&#x2009;+&#x2009;1</span> elements starting at the <span class="tex-span"><i>l</i></span>-th DNA sequence element and ending at the <span class="tex-span"><i>r</i></span>-th DNA sequence element.</p></div><div class="output-specification"><div class="section-title">Output</div><p>Output a single line, containing the first <span class="tex-span"><i>k</i></span> letters of the mutated DNA sequence.</p></div><div class="sample-tests"><div class="section-title">Sample test(s)</div><div class="sample-test"><div class="input"><div class="title">Input</div><pre>GAGA<br>4<br>0<br></pre></div><div class="output"><div class="title">Output</div><pre>GAGA<br></pre></div><div class="input"><div class="title">Input</div><pre>ACGTACGT<br>16<br>2<br>1 2<br>2 8<br></pre></div><div class="output"><div class="title">Output</div><pre>ACCAGTACCGACATCG<br></pre></div></div></div><div class="note"><div class="section-title">Note</div><p>In the second example, after the first mutation the sequence is &quot;<span class="tex-font-style-tt">ACCAGTACGT</span>&quot;. After the second mutation it&apos;s &quot;<span class="tex-font-style-tt">ACCAGTACCGACATCGT</span>&quot;.</p></div></div></div>
</div>